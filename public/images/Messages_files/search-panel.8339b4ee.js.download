/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[337],{1205:function(e,t,n){"use strict";n(802)},1206:function(e,t,n){var r=n(6)(!1);r.push([e.i,".room-list-category-header[data-v-9d6cd76e]{padding:20px 20px 5px;font-weight:var(--font-weight-700)}",""]),e.exports=r},1207:function(e){e.exports=JSON.parse('{"thun_NoRoomsFoundThatMatchYourSearch_99":"No rooms found that match your search","thun_SearchFailedTryAgain_408":"Search failed, try again","thun_SorryYouDonTHaveAccessToThisRoom_409":"Sorry, you don\'t have access to this room","thun_AnErrorHasOccurredWhileProcessingYourReq_410":"An error has occurred while processing your request, please try again"}')},1208:function(e){e.exports=JSON.parse('{"thun_NoRoomsFoundThatMatchYourSearch_99":"No rooms found that match your search","thun_SearchFailedTryAgain_408":"Search failed, try again","thun_SorryYouDonTHaveAccessToThisRoom_409":"Sorry, you don\'t have access to this room","thun_AnErrorHasOccurredWhileProcessingYourReq_410":"An error has occurred while processing your request, please try again"}')},1209:function(e){e.exports=JSON.parse('{"thun_NoRoomsFoundThatMatchYourSearch_99":"[猫No rooms found that match your search猫]","thun_SearchFailedTryAgain_408":"[猫Search failed, try again猫]","thun_SorryYouDonTHaveAccessToThisRoom_409":"[猫Sorry, you don\'t have access to this room猫]","thun_AnErrorHasOccurredWhileProcessingYourReq_410":"[猫An error has occurred while processing your request, please try again猫]"}')},1210:function(e,t,n){"use strict";n(803)},1211:function(e,t,n){var r=n(6)(!1);r.push([e.i,".up-d-search-rooms[data-v-6d5d18e7]{min-height:60px;min-height:var(--search-rooms-height,60px);display:flex;flex-direction:column;--room-list-item-border:1px}.up-d-search-rooms.with-query[data-v-6d5d18e7]{flex-grow:1}.up-d-search-rooms[data-v-6d5d18e7]:not(.is-native-view){--room-list-item-height:60px;--room-list-item-border:0}section[data-v-6d5d18e7]{height:100%}.virtual-list[data-v-6d5d18e7]{height:100%;overflow-y:auto}",""]),e.exports=r},1223:function(e){e.exports=JSON.parse('{"thun_NoMessagesFoundThatMatchYourSearch_98":"No messages found that match your search"}')},1224:function(e){e.exports=JSON.parse('{"thun_NoMessagesFoundThatMatchYourSearch_98":"No messages found that match your search"}')},1225:function(e){e.exports=JSON.parse('{"thun_NoMessagesFoundThatMatchYourSearch_98":"[猫No messages found that match your search猫]"}')},1235:function(e,t,n){"use strict";n(1);var r=n(165),map=n(195),o=n(267),l=n(167),c=n(153);var d=n(1266),filter=n(337),h=n(2),m=n(381),f=n(805),v=n(203),y=n(51),O=n(811),S={"en-gb":n(1223),en:n(1224),is:n(1225)};const I=m.b.MESSAGES;var N={i18n:{messages:S},name:"UpDSearchMessages",props:{query:String,roomId:String},components:{UpDMessageList:O.a},watch:{query:{immediate:!0,handler(e){this.searchQuery(e,this.roomId)}}},methods:{loadMore(){this.loadingMore[I]||this.searchMore(I,this.roomId).subscribe()},onStoryClick(){this.sendMessageSearchEvent("open_message_search_result","click")}},setup(){const{loading:e,loadingMore:t,result:n,searchQuery:m,searchMore:O}=Object(f.a)(),{$thunderTracker:S}=Object(y.b)(),N=(label,e)=>{S.track({label:label,event:e,sublocation:"message_search_panel"})},T=new r.b;return T.add(Object(v.d)(e).pipe(Object(map.a)((e=>{let[t]=e;return t[I]})),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object(l.c)(e);return Object(c.a)((function(source,t){(n?Object(o.a)(e,source,n):Object(o.a)(e,source)).subscribe(t)}))}(!0),Object(d.a)(),Object(filter.a)((e=>{let[t,n]=e;return!n&&t}))).subscribe((()=>{N("view_message_search_results","impression")}))),Object(h.j)((()=>T.unsubscribe())),{loading:e,loadingMore:t,result:n,searchQuery:m,searchMore:O,searchSection:I,sendMessageSearchEvent:N}}},T=N,E=n(4),component=Object(E.a)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("up-d-message-list",{attrs:{loading:e.loading[e.searchSection],stories:e.result[e.searchSection],query:e.query},on:{loadMore:e.loadMore,storyClick:e.onStoryClick}},[n("h3",{staticClass:"h5"},[e._v(e._s(e.$t("thun_NoMessagesFoundThatMatchYourSearch_98")))])])}),[],!1,null,null,null);t.a=component.exports},1266:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(153),o=n(154);function l(){return Object(r.a)((function(source,e){var t,n=!1;source.subscribe(Object(o.a)(e,(function(r){var p=t;t=r,n&&e.next([p,r]),n=!0})))}))}},1439:function(e,t,n){var content=n(2114);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(7).default)("bd707764",content,!0,{sourceMap:!1,manualInject:!0})},1454:function(e,t,n){"use strict";n.r(t);n(1);var r=n(178),o=n(165),l=n(489),map=n(195),c=n(204),filter=n(337),d=n(2),h=n(801),m=n.n(h),f=n(720),v=n(51),y=n(338),O=n(452),S=n(201);const I=(e,t)=>{const n=Object(d.m)([]),r=Object(d.a)((()=>t.reduce(((e,t)=>(e[t.roomId]=t,e)),{})));return Object(d.r)(e.results,(e=>{n.value=[],(e=>{const{people:t,groups:n,interviews:r}=e.reduce(((e,t)=>{switch(t.roomType){case S.a.ONE_ON_ONE:return e.people.push(t),e;case S.a.INTERVIEW:return t.contractId?e.people.push(t):e.interviews.push(t),e;case S.a.GROUP:return e.groups.push(t),e;default:console.error("Unexpected variable",t.roomType)}return e}),{people:[],groups:[],interviews:[]});return t.length&&t.unshift({id:"People"}),n.length&&n.unshift({id:"Groups"}),r.length&&r.unshift({id:"Interviews"}),t.concat(r.concat(n))})(e).forEach((e=>{n.value.push(r.value[e.roomId]||e)}))})),{searchApi:e,groupedResults:n}};var N=n(697),T=n(300),E=n(443),k={name:"UpDSearchListItem",props:{source:[T.a,E.a,Object],showCounter:{type:Boolean,default:!1},avatarSize:Number,select:Function},components:{UpDRoomListItem:N.a},computed:{isRoom(){return this.source instanceof T.a||this.source instanceof E.a}}},x=(n(1205),n(4)),_=Object(x.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isRoom?n("up-d-room-list-item",{attrs:{room:e.source,"show-timestamp":!1,"show-counter":e.showCounter,"avatar-size":e.avatarSize},on:{select:e.select}}):n("header",{staticClass:"room-list-category-header"},[e._v(e._s(e.source.id))])}),[],!1,null,"9d6cd76e",null).exports,j=n(265),D=n(203),w={i18n:{messages:{"en-gb":n(1207),en:n(1208),is:n(1209)}},name:"UpDSearchRooms",components:{UpDEmptyState:j.a,VirtualList:m.a,UpDRoomListItem:N.a,UpDSearchListItem:_,UpDProgressBar:f.default},props:{query:String,detailedRooms:{type:Array,required:!1,default:()=>[]},showCounter:Boolean,isNativeView:Boolean},data:()=>({...O.a,SEARCH_STATUS_FOUND:O.a.FOUND,SEARCH_STATUS_PENDING:O.a.PENDING,skeletonRooms:Object(y.c)(3),itemComponent:_,scrolled$:new r.a,contactRooms:{}}),computed:{illustrationNoContacts:()=>()=>n.e(91).then(n.bind(null,2335))},watch:{query:{immediate:!0,handler(e){this.searchRooms(e)}},error(e){e&&this.status===O.a.NOT_FOUND&&this.createToaster({type:"danger",duration:5e3,close:!0,content:this.$t("thun_SearchFailedTryAgain_408")})},groupedResults(e){this.loadDetails(e.slice(0,20)).subscribe()}},methods:{getRoomKey:e=>e.id||e.targetUserId,onSelect(e){if(e.roomId)this.$emit("select",{room:e});else if(this.contactRooms[e.targetUserId]){const t=this.contactRooms[e.targetUserId];this.$emit("select",{contact:e,room:t})}else this.getOneOnOneRoom(e).then((t=>{const n=new T.a(t);this.contactRooms[e.targetUserId]=n,e.roomId=t.roomId,this.$emit("select",{contact:e,room:n})})).catch((e=>{const t=403===e.status?this.$t("thun_SorryYouDonTHaveAccessToThisRoom_409"):this.$t("thun_AnErrorHasOccurredWhileProcessingYourReq_410");this.createToaster({type:"danger",duration:0,content:t,close:!0})}))}},setup(e){const{$auth:t,$httpGql:n,$thunderTracker:h}=Object(v.b)(),m=Object(O.b)(t,n),f=Object(O.c)(),{groupedResults:y}=I(m,e.detailedRooms),S=new r.a,N=new o.b;Object(d.i)((()=>{N.add(S.pipe(Object(l.a)(200),Object(map.a)((e=>f(y.value.slice(e.start,20)))),Object(c.a)()).subscribe()),N.add(Object(D.d)([m.status]).pipe(Object(map.a)((e=>{let[t]=e;return t})),Object(filter.a)((e=>e===O.a.FOUND))).subscribe((()=>h.track({label:"view_spotlight_results",sublocation:"spotlight_search_panel",event:"impression"}))))})),Object(d.j)((()=>{N.unsubscribe()}));return{...m,groupedResults:y,loadDetails:f,onVirtualScroll:(e,t)=>{S.next(t)}}}},F=(n(1210),Object(x.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"up-d-search-rooms",class:{"with-query":e.query,"is-native-view":e.isNativeView}},[e.showProgressBar?n("up-d-progress-bar",{attrs:{"track-page":!1}}):e._e(),e._v(" "),e.query&&e.status===e.NOT_FOUND?n("up-d-empty-state",{attrs:{illustration:e.illustrationNoContacts}},[n("h3",{staticClass:"h5"},[e._v(e._s(e.$t("thun_NoRoomsFoundThatMatchYourSearch_99")))])]):e._e(),e._v(" "),e.status===e.SEARCH_STATUS_PENDING?n("section",e._l(e.skeletonRooms,(function(e){return n("up-d-room-list-item",{key:e.id,attrs:{room:e,"show-timestamp":!1}})})),1):e._e(),e._v(" "),e.status===e.SEARCH_STATUS_FOUND?n("section",[n("virtual-list",{staticClass:"virtual-list",attrs:{"data-key":e.getRoomKey,"data-sources":e.groupedResults,"data-component":e.itemComponent,keeps:20,"estimate-size":e.isNativeView?75:60,"page-mode":e.isNativeView,"extra-props":{showCounter:e.showCounter,select:e.onSelect,avatarSize:e.isNativeView?45:35}},on:{scroll:e.onVirtualScroll}})],1):e._e()],1)}),[],!1,null,"6d5d18e7",null));t.default=F.exports},2113:function(e,t,n){"use strict";n(1439)},2114:function(e,t,n){var r=n(6)(!1);r.push([e.i,".search-container[data-v-b5d23ab2]{display:flex;height:calc(100% - var(--search-input-height))}",""]),e.exports=r},2350:function(e,t,n){"use strict";n.r(t);var r=n(51),o=n(381),l=n(701),c=n(447),d=n(1454),h=n(1235),m={name:"UpDSearchPanel",props:{query:String,searchSection:String},components:{KeepAlive:l.a,UpDSearchRooms:d.default,UpDSearchMessages:h.a},data:()=>({SearchType:o.b}),methods:{navigateRoom(e){this.$router.push({name:"rooms",params:{roomId:e.roomId},query:{companyReference:this.$auth.orgId}})},onSelect(e){let{room:t,contact:n}=e;this.$thunderTracker.track({label:"select_search_result",sublocation:"spotlight_search_panel",event:"click"}),this.searchUpdate(t,n),n&&this.navigateRoom(t)}},setup(){const{$auth:e}=Object(r.b)();return Object(c.a)(e)}},f=(n(2113),n(4)),component=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-container"},[n("up-d-search-rooms",{directives:[{name:"show",rawName:"v-show",value:e.searchSection===e.SearchType.ROOMS,expression:"searchSection === SearchType.ROOMS"}],attrs:{query:e.query,"show-counter":e.showCounter},on:{select:e.onSelect}}),e._v(" "),n("keep-alive",[e.searchSection===e.SearchType.MESSAGES?n("up-d-search-messages",{attrs:{query:e.query}}):e._e()],1)],1)}),[],!1,null,"b5d23ab2",null);t.default=component.exports},327:function(e,t,n){"use strict";function r(code){return 9===code||32===code}n.d(t,"a",(function(){return F}));const o=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function l(e){return c[e.charCodeAt(0)]}const c=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"];function d(e,t){if(!Boolean(e))throw new Error(t)}const h=10,m=2;function f(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";const n=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:f(t,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>m)return"[Array]";const n=Math.min(h,e.length),r=e.length-n,o=[];for(let i=0;i<n;++i)o.push(f(e[i],t));1===r?o.push("... 1 more item"):r>1&&o.push(`... ${r} more items`);return"["+o.join(", ")+"]"}(e,n);return function(object,e){const t=Object.entries(object);if(0===t.length)return"{}";if(e.length>m)return"["+function(object){const e=Object.prototype.toString.call(object).replace(/^\[object /,"").replace(/]$/,"");if("Object"===e&&"function"==typeof object.constructor){const e=object.constructor.name;if("string"==typeof e&&""!==e)return e}return e}(object)+"]";const n=t.map((([t,n])=>t+": "+f(n,e)));return"{ "+n.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}Symbol.toStringTag;Symbol.toStringTag;const v={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},y=new Set(Object.keys(v));function O(e){const t=null==e?void 0:e.kind;return"string"==typeof t&&y.has(t)}var S,I;!function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(S||(S={})),function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(I||(I={}));const N=Object.freeze({});function T(e,t){const n=e[t];return"object"==typeof n?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:e.enter,leave:e.leave}}function E(e){return function(e,t,n=v){const r=new Map;for(const e of Object.values(I))r.set(e,T(t,e));let o,l,c,h=Array.isArray(e),m=[e],y=-1,S=[],E=e;const path=[],k=[];do{y++;const e=y===m.length,v=e&&0!==S.length;if(e){if(l=0===k.length?void 0:path[path.length-1],E=c,c=k.pop(),v)if(h){E=E.slice();let e=0;for(const[t,n]of S){const r=t-e;null===n?(E.splice(r,1),e++):E[r]=n}}else{E=Object.defineProperties({},Object.getOwnPropertyDescriptors(E));for(const[e,t]of S)E[e]=t}y=o.index,m=o.keys,S=o.edits,h=o.inArray,o=o.prev}else if(c){if(l=h?y:m[y],E=c[l],null==E)continue;path.push(l)}let I;if(!Array.isArray(E)){var x,_;O(E)||d(!1,`Invalid AST Node: ${D=E,f(D,[])}.`);const n=e?null===(x=r.get(E.kind))||void 0===x?void 0:x.leave:null===(_=r.get(E.kind))||void 0===_?void 0:_.enter;if(I=null==n?void 0:n.call(t,E,l,c,path,k),I===N)break;if(!1===I){if(!e){path.pop();continue}}else if(void 0!==I&&(S.push([l,I]),!e)){if(!O(I)){path.pop();continue}E=I}}var j;void 0===I&&v&&S.push([l,E]),e?path.pop():(o={inArray:h,index:y,keys:m,edits:S,prev:o},h=Array.isArray(E),m=h?E:null!==(j=n[E.kind])&&void 0!==j?j:[],y=-1,S=[],c&&k.push(c),c=E)}while(void 0!==o);var D;return 0!==S.length?S[S.length-1][1]:e}(e,k)}const k={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>x(e.definitions,"\n\n")},OperationDefinition:{leave(e){const t=j("(",x(e.variableDefinitions,", "),")"),n=x([e.operation,x([e.name,t]),x(e.directives," ")]," ");return("query"===n?"":n+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:n,directives:r})=>e+": "+t+j(" = ",n)+j(" ",x(r," "))},SelectionSet:{leave:({selections:e})=>_(e)},Field:{leave({alias:e,name:t,arguments:n,directives:r,selectionSet:o}){const l=j("",e,": ")+t;let c=l+j("(",x(n,", "),")");return c.length>80&&(c=l+j("(\n",D(x(n,"\n")),"\n)")),x([c,x(r," "),o]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+j(" ",x(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:n})=>x(["...",j("on ",e),x(t," "),n]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:n,directives:r,selectionSet:o})=>`fragment ${e}${j("(",x(n,", "),")")} on ${t} ${j("",x(r," ")," ")}`+o},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?function(e,t){const n=e.replace(/"""/g,'\\"""'),o=n.split(/\r\n|[\n\r]/g),l=1===o.length,c=o.length>1&&o.slice(1).every((line=>0===line.length||r(line.charCodeAt(0)))),d=n.endsWith('\\"""'),h=e.endsWith('"')&&!d,m=e.endsWith("\\"),f=h||m,v=!(null!=t&&t.minimize)&&(!l||e.length>70||f||c||d);let y="";const O=l&&r(e.charCodeAt(0));return(v&&!O||c)&&(y+="\n"),y+=n,(v||f)&&(y+="\n"),'"""'+y+'"""'}(e):`"${e.replace(o,l)}"`},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+x(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+x(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+j("(",x(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:n})=>j("",e,"\n")+x(["schema",x(t," "),_(n)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:n})=>j("",e,"\n")+x(["scalar",t,x(n," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:o})=>j("",e,"\n")+x(["type",t,j("implements ",x(n," & ")),x(r," "),_(o)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:n,type:r,directives:o})=>j("",e,"\n")+t+(w(n)?j("(\n",D(x(n,"\n")),"\n)"):j("(",x(n,", "),")"))+": "+r+j(" ",x(o," "))},InputValueDefinition:{leave:({description:e,name:t,type:n,defaultValue:r,directives:o})=>j("",e,"\n")+x([t+": "+n,j("= ",r),x(o," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:o})=>j("",e,"\n")+x(["interface",t,j("implements ",x(n," & ")),x(r," "),_(o)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:n,types:r})=>j("",e,"\n")+x(["union",t,x(n," "),j("= ",x(r," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:n,values:r})=>j("",e,"\n")+x(["enum",t,x(n," "),_(r)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:n})=>j("",e,"\n")+x([t,x(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:n,fields:r})=>j("",e,"\n")+x(["input",t,x(n," "),_(r)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:n,repeatable:r,locations:o})=>j("",e,"\n")+"directive @"+t+(w(n)?j("(\n",D(x(n,"\n")),"\n)"):j("(",x(n,", "),")"))+(r?" repeatable":"")+" on "+x(o," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>x(["extend schema",x(e," "),_(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>x(["extend scalar",e,x(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>x(["extend type",e,j("implements ",x(t," & ")),x(n," "),_(r)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>x(["extend interface",e,j("implements ",x(t," & ")),x(n," "),_(r)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:n})=>x(["extend union",e,x(t," "),j("= ",x(n," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:n})=>x(["extend enum",e,x(t," "),_(n)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:n})=>x(["extend input",e,x(t," "),_(n)]," ")}};function x(e,t=""){var n;return null!==(n=null==e?void 0:e.filter((e=>e)).join(t))&&void 0!==n?n:""}function _(e){return j("{\n",D(x(e,"\n")),"\n}")}function j(e,t,n=""){return null!=t&&""!==t?e+t+n:""}function D(e){return j("  ",e.replace(/\n/g,"\n  "))}function w(e){var t;return null!==(t=null==e?void 0:e.some((e=>e.includes("\n"))))&&void 0!==t&&t}const F=e=>({fetchQueryResult:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e({handleApiErrors:!1}).post({query:E(t),variables:n}).json()}})},411:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"query"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"usersContacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"query"}}},{kind:"ObjectField",name:{kind:"Name",value:"includeInactive"},value:{kind:"BooleanValue",value:!0}}]}},{kind:"Argument",name:{kind:"Name",value:"pagination"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"ObjectField",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"total"},name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cursor"},name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"contact"},name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"userId"},name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"legacyId"},name:{kind:"Name",value:"nid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"portrait"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"photoUrl"},name:{kind:"Name",value:"portrait100"},arguments:[],directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"fullName"},name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"score"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"country"},name:{kind:"Name",value:"countryName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cityName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"organization"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"orgId"},name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"orgName"},name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:665}};n.loc.source={body:"query ($query: String, $limit: Int!, $cursor: String) {\n  usersContacts(\n    filter: { query: $query, includeInactive: true }\n    pagination: { first: $limit, after: $cursor }\n  ) {\n    total: totalCount\n    pageInfo {\n      cursor: endCursor\n    }\n    contact: edges {\n      cursor\n      node {\n        user {\n          userId: id\n          legacyId: nid\n          portrait {\n            photoUrl: portrait100\n          }\n        }\n        fullName: name\n        score\n        location {\n          country: countryName\n          cityName\n          timezone\n        }\n        organization {\n          orgId: id\n          orgName: name\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function r(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){r(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){r(e,t)})),e.definitions&&e.definitions.forEach((function(e){r(e,t)}))}var o={};n.definitions.forEach((function(e){if(e.name){var t=new Set;r(e,t),o[e.name.value]=t}})),e.exports=n},415:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(1);var r=n(215),o=n(327),l=n(411),c=n.n(l);const d=e=>{const{fetchQueryResult:t}=Object(o.a)(e),n=Object(r.a)();return{getContactsGql:e=>{let{query:r="",limit:o=200}=e;return t(c.a,{query:r,limit:o}).then((e=>{let{data:data}=e;var t;const n=((null===(t=null==data?void 0:data.usersContacts)||void 0===t?void 0:t.contact)||[]).map((e=>{let{node:t}=e;var n;const{fullName:r,user:o,organization:l,location:c}=t,d=null===(n=null==o?void 0:o.portrait)||void 0===n?void 0:n.photoUrl;delete o.portrait;const[h,m]=null==r?void 0:r.split(" ");return{...o,fullName:r,firstName:h,lastName:m,...l,photoUrl:d,...c}}));return(e=>{const t={};return e.forEach((e=>{t[e.fullName]=(t[e.fullName]||[]).concat(e)})),e.forEach((e=>{const n=t[e.fullName]||[],r=new Set,o=new Set;if(n.forEach((e=>{r.add(e.legacyId),o.add(e.orgId)})),r.size>1&&o.size>1){const t=e.fullName!==e.orgName?"- ".concat(e.orgName):"";e.subtitle="".concat(e.legacyId," ").concat(t)}else r.size>1?e.subtitle=e.legacyId:o.size>1&&(e.subtitle=e.orgName)})),e})(n)})).catch((e=>{n.error(e)}))}}}},443:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(381),o=n(2);class l extends r.a{constructor(data){super(data),this.targetUser=null,Object.assign(this,Object(o.n)(this))}setUser(e){this.targetUser=e}}},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"c",(function(){return V}));n(1);var r=n(291),o=n(382),l=n(357),c=n(323),d=n(169),h=n(178),m=n(336),f=n(292),map=n(195),filter=n(337),v=n(489),y=n(290),O=n(153),S=n(154),I=n(166),N=n(281),T=n(155);var E=n(2),k=n(177),x=n(300),_=n(214),j=n(201),D={"en-gb":n(480),en:n(481),is:n(482)};const w=(e,t)=>e.fullName||"".concat(e.firstName||""," ").concat(e.lastName||"").trim()||t.t("thun_Person_581");var F=n(224);var R=n(225),C=n(51),z=n(415),A=n(200),U=n(221),M=n(170);const P={PRELOADING:"PRELOADING",IDLE:"IDLE",PENDING:"PENDING",FOUND:"FOUND",NOT_FOUND:"NOT_FOUND"},V=()=>{const{loadPersons:e}=Object(U.a)(),t=new A.a,n={},l=(e,t)=>{e.forEach((e=>{n[e]=t}))};return c=>Object(o.a)((t=>{const o=t.filter((e=>{let{targetUserId:t,targetUser:n}=e;return t&&(!n||!n.status)})),c=o.filter((e=>{let{targetUserId:t}=e;return t&&!n[t]})).map((e=>e.targetUserId));return l(c,!0),e(c).pipe(Object(m.a)((e=>{o.forEach((t=>{e[t.targetUserId]&&t.setUser(e[t.targetUserId])})),l(c,!1)})),Object(f.a)((()=>(l(c,!1),Object(r.a)([])))))})(c),(e=>{const r=e.filter((e=>{let{isAgencyDirectMessage:t,relatedAgency:r,roomId:o}=e;return t&&!r&&!n[o]}));return l(r.map((e=>e.roomId)),!0),Object(o.a)(...r.map((e=>t.getAgencyMetadata(e.roomId).pipe(Object(m.a)((t=>{e.setAgency(t),l([e.roomId],!1)}))))))})(c))};t.b=(e,t)=>{Object(C.a)(D);const n=Object(E.m)(P.PRELOADING),o=Object(E.m)(),U=Object(E.m)(!1),{getContactsGql:V}=Object(z.a)(t);let $=null;const L=Object(E.m)([]),B=new A.a,H=async function(){return V({query:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",limit:200}).then((e=>e.map((e=>{const t=new x.a(function(e,t){return new _.a({roomId:null,roomName:w(e,t),topic:null,roomType:j.a.ONE_ON_ONE,targetUserId:e.userId,targetOrgId:e.orgId,targetOrgName:e.orgName,subtitle:e.subtitle,isPublic:0,isContactRoom:1})}(e));return t.setUser(new R.a(function(e){return new F.a({location:{...e},personName:{...e},...e})}(e))),t}))))},Y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(l.a)((()=>Object(c.a)(Object(d.a)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return B.getRoomsSummary({query:e,limit:200}).then((e=>e.map((e=>new x.a(e)))))}(e)),Object(d.a)(H(e))).pipe(Object(map.a)((e=>{let[t,n]=e;return t.concat(n.filter((a=>{const e=t.filter((b=>a.targetUserId===b.targetUserId&&a.targetOrgId===b.targetOrgId)),n=e.find((b=>a.roomTypeName===b.roomTypeName));return n&&(n.subtitle=a.subtitle),0===e.length})))})),Object(m.a)((e=>{$||($=e)})),Object(f.a)((e=>(o.value=e,Object(r.a)([])))))))},G=e=>{var t;null===(t=$)||void 0===t||t.push(new x.a({...e}))},K=t=>{let{userId:n,orgId:r,roomId:o}=t;$&&e.userId===n&&e.orgId===r&&($=$.filter((e=>e.roomId!==o)))},J=e=>{var t;let{roomId:n,...data}=e;const r=null===(t=$)||void 0===t?void 0:t.find((e=>e.roomId===n));r&&r.update(data)};let X=null;Object(E.i)((()=>{Object(M.a)((e=>{e.on("newRoom",G),e.on("removeUser",K),e.on("updateRoom",J)})),n.value=P.PRELOADING,X=Y()})),Object(E.j)((()=>{Object(M.a)((e=>{e._off("newRoom",G),e._off("removeUser",K),e._off("updateRoom",J)}))}));const W=(e,t)=>e.filter((e=>t.every((t=>{var n;return e.roomName.match(t)||(null===(n=e.topic)||void 0===n?void 0:n.match(t))})))),Q=new h.a;return Q.pipe(Object(m.a)((e=>{e?n.value=P.PENDING:(L.value=[],n.value=P.IDLE)})),Object(filter.a)((e=>e)),Object(v.a)(300),Object(y.a)((e=>$?Object(r.a)($).pipe(Object(map.a)((t=>[t,e]))):X.pipe(function(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,r=void 0===n?1/0:n,o=t.delay,l=t.resetOnSuccess,c=void 0!==l&&l;return r<=0?I.a:Object(O.a)((function(source,e){var t,n=0,l=function(){var d=!1;t=source.subscribe(Object(S.a)(e,(function(t){c&&(n=0),e.next(t)}),void 0,(function(c){if(n++<r){var h=function(){t?(t.unsubscribe(),t=null,l()):d=!0};if(null!=o){var m="number"==typeof o?Object(N.a)(o):Object(T.a)(o(c,n)),f=Object(S.a)(e,(function(){f.unsubscribe(),h()}),(function(){e.complete()}));m.subscribe(f)}else h()}else e.error(c)}))),d&&(t.unsubscribe(),t=null,l())};l()}))}(1),Object(map.a)((t=>[t,e]))))),Object(map.a)((e=>{let[t,n]=e;const r=Object(k.b)(n).toLowerCase().trim().split(/\s+/g).map((e=>new RegExp(e,"i")));return[W(t,r),n,r]})),Object(m.a)((e=>{let[t,r,o]=e;L.value=t,n.value=P[t.length?"FOUND":"NOT_FOUND"],((e,t)=>{U.value=!0,Y(e).pipe(Object(map.a)((e=>{var n;return $=null===(n=$)||void 0===n?void 0:n.concat(e.filter((a=>!$.find((b=>a.roomId&&b.roomId?a.roomId===b.roomId:!a.roomId&&!b.roomId&&a.targetUserId===b.targetUserId&&a.targetOrgId===b.targetOrgId))))),W($,t)})),Object(m.a)((e=>{L.value=e,U.value=!1}))).subscribe()})(r,o)}))).subscribe(),{searchRooms:e=>Q.next(e),getOneOnOneRoom:e=>B.getOneOnOneRoom({userId:e.targetUserId,orgId:e.targetOrgId}),results:L,status:Object(E.a)((()=>n.value)),error:o,showProgressBar:U}}},480:function(e){e.exports=JSON.parse('{"thun_Person_581":"Person"}')},481:function(e){e.exports=JSON.parse('{"thun_Person_581":"Person"}')},482:function(e){e.exports=JSON.parse('{"thun_Person_581":"[猫Person猫]"}')},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(443);class o extends r.a{constructor(data){super(data),this.id=data.storyId,this.user=null}setUser(e){this.user=e}}},615:function(e,t,n){var content=n(807);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(7).default)("361acf3c",content,!0,{sourceMap:!1,manualInject:!0})},616:function(e,t,n){var content=n(809);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(7).default)("1e056fd8",content,!0,{sourceMap:!1,manualInject:!0})},801:function(e,t,n){e.exports=function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){o(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function d(e){return h(e)||m(e)||f(e)||y()}function h(e){if(Array.isArray(e))return v(e)}function m(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function f(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var O={FRONT:"FRONT",BEHIND:"BEHIND"},S={INIT:"INIT",FIXED:"FIXED",DYNAMIC:"DYNAMIC"},I=0,N=function(){function e(param,n){t(this,e),this.init(param,n)}return r(e,[{key:"init",value:function(param,e){this.param=param,this.callUpdate=e,this.sizes=new Map,this.firstRangeTotalSize=0,this.firstRangeAverageSize=0,this.lastCalcIndex=0,this.fixedSizeValue=0,this.calcType=S.INIT,this.offset=0,this.direction="",this.range=Object.create(null),param&&this.checkRange(0,param.keeps-1)}},{key:"destroy",value:function(){this.init(null,null)}},{key:"getRange",value:function(){var e=Object.create(null);return e.start=this.range.start,e.end=this.range.end,e.padFront=this.range.padFront,e.padBehind=this.range.padBehind,e}},{key:"isBehind",value:function(){return this.direction===O.BEHIND}},{key:"isFront",value:function(){return this.direction===O.FRONT}},{key:"getOffset",value:function(e){return(e<1?0:this.getIndexOffset(e))+this.param.slotHeaderSize}},{key:"updateParam",value:function(e,t){var n=this;this.param&&e in this.param&&("uniqueIds"===e&&this.sizes.forEach((function(e,r){t.includes(r)||n.sizes.delete(r)})),this.param[e]=t)}},{key:"saveSize",value:function(e,t){this.sizes.set(e,t),this.calcType===S.INIT?(this.fixedSizeValue=t,this.calcType=S.FIXED):this.calcType===S.FIXED&&this.fixedSizeValue!==t&&(this.calcType=S.DYNAMIC,delete this.fixedSizeValue),this.calcType!==S.FIXED&&void 0!==this.firstRangeTotalSize&&(this.sizes.size<Math.min(this.param.keeps,this.param.uniqueIds.length)?(this.firstRangeTotalSize=d(this.sizes.values()).reduce((function(e,t){return e+t}),0),this.firstRangeAverageSize=Math.round(this.firstRangeTotalSize/this.sizes.size)):delete this.firstRangeTotalSize)}},{key:"handleDataSourcesChange",value:function(){var e=this.range.start;this.isFront()?e-=I:this.isBehind()&&(e+=I),e=Math.max(e,0),this.updateRange(this.range.start,this.getEndByStart(e))}},{key:"handleSlotSizeChange",value:function(){this.handleDataSourcesChange()}},{key:"handleScroll",value:function(e){this.direction=e<this.offset?O.FRONT:O.BEHIND,this.offset=e,this.param&&(this.direction===O.FRONT?this.handleFront():this.direction===O.BEHIND&&this.handleBehind())}},{key:"handleFront",value:function(){var e=this.getScrollOvers();if(!(e>this.range.start)){var t=Math.max(e-this.param.buffer,0);this.checkRange(t,this.getEndByStart(t))}}},{key:"handleBehind",value:function(){var e=this.getScrollOvers();e<this.range.start+this.param.buffer||this.checkRange(e,this.getEndByStart(e))}},{key:"getScrollOvers",value:function(){var e=this.offset-this.param.slotHeaderSize;if(e<=0)return 0;if(this.isFixedType())return Math.floor(e/this.fixedSizeValue);for(var t=0,n=0,r=0,o=this.param.uniqueIds.length;t<=o;){if(n=t+Math.floor((o-t)/2),(r=this.getIndexOffset(n))===e)return n;r<e?t=n+1:r>e&&(o=n-1)}return t>0?--t:0}},{key:"getIndexOffset",value:function(e){if(!e)return 0;for(var t=0,n=0,r=0;r<e;r++)t+="number"==typeof(n=this.sizes.get(this.param.uniqueIds[r]))?n:this.getEstimateSize();return this.lastCalcIndex=Math.max(this.lastCalcIndex,e-1),this.lastCalcIndex=Math.min(this.lastCalcIndex,this.getLastIndex()),t}},{key:"isFixedType",value:function(){return this.calcType===S.FIXED}},{key:"getLastIndex",value:function(){return this.param.uniqueIds.length-1}},{key:"checkRange",value:function(e,t){var n=this.param.keeps;this.param.uniqueIds.length<=n?(e=0,t=this.getLastIndex()):t-e<n-1&&(e=t-n+1),this.range.start!==e&&this.updateRange(e,t)}},{key:"updateRange",value:function(e,t){this.range.start=e,this.range.end=t,this.range.padFront=this.getPadFront(),this.range.padBehind=this.getPadBehind(),this.callUpdate(this.getRange())}},{key:"getEndByStart",value:function(e){var t=e+this.param.keeps-1;return Math.min(t,this.getLastIndex())}},{key:"getPadFront",value:function(){return this.isFixedType()?this.fixedSizeValue*this.range.start:this.getIndexOffset(this.range.start)}},{key:"getPadBehind",value:function(){var e=this.range.end,t=this.getLastIndex();return this.isFixedType()?(t-e)*this.fixedSizeValue:this.lastCalcIndex===t?this.getIndexOffset(t)-this.getIndexOffset(e):(t-e)*this.getEstimateSize()}},{key:"getEstimateSize",value:function(){return this.isFixedType()?this.fixedSizeValue:this.firstRangeAverageSize||this.param.estimateSize}}]),e}(),T={dataKey:{type:[String,Function],required:!0},dataSources:{type:Array,required:!0},dataComponent:{type:[Object,Function],required:!0},keeps:{type:Number,default:30},extraProps:{type:Object},estimateSize:{type:Number,default:50},direction:{type:String,default:"vertical"},start:{type:Number,default:0},offset:{type:Number,default:0},topThreshold:{type:Number,default:0},bottomThreshold:{type:Number,default:0},pageMode:{type:Boolean,default:!1},rootTag:{type:String,default:"div"},wrapTag:{type:String,default:"div"},wrapClass:{type:String,default:""},wrapStyle:{type:Object},itemTag:{type:String,default:"div"},itemClass:{type:String,default:""},itemClassAdd:{type:Function},itemStyle:{type:Object},headerTag:{type:String,default:"div"},headerClass:{type:String,default:""},headerStyle:{type:Object},footerTag:{type:String,default:"div"},footerClass:{type:String,default:""},footerStyle:{type:Object},itemScopedSlots:{type:Object}},E={index:{type:Number},event:{type:String},tag:{type:String},horizontal:{type:Boolean},source:{type:Object},component:{type:[Object,Function]},slotComponent:{type:Function},uniqueKey:{type:[String,Number]},extraProps:{type:Object},scopedSlots:{type:Object}},k={event:{type:String},uniqueKey:{type:String},tag:{type:String},horizontal:{type:Boolean}},x={created:function(){this.shapeKey=this.horizontal?"offsetWidth":"offsetHeight"},mounted:function(){var e=this;"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(){e.dispatchSizeChange()})),this.resizeObserver.observe(this.$el))},updated:function(){this.dispatchSizeChange()},beforeDestroy:function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},methods:{getCurrentSize:function(){return this.$el?this.$el[this.shapeKey]:0},dispatchSizeChange:function(){this.$parent.$emit(this.event,this.uniqueKey,this.getCurrentSize(),this.hasInitial)}}},_=e.component("virtual-list-item",{mixins:[x],props:E,render:function(e){var t=this.tag,component=this.component,n=this.extraProps,r=void 0===n?{}:n,o=this.index,source=this.source,l=this.scopedSlots,d=void 0===l?{}:l,h=this.uniqueKey,m=this.slotComponent,f=c({},r,{source:source,index:o});return e(t,{key:h,attrs:{role:"listitem"}},[m?e("div",m({item:source,index:o,scope:f})):e(component,{props:f,scopedSlots:d})])}}),j=e.component("virtual-list-slot",{mixins:[x],props:k,render:function(e){var t=this.tag,n=this.uniqueKey;return e(t,{key:n,attrs:{role:n}},this.$slots.default)}}),D={ITEM:"item_resize",SLOT:"slot_resize"},w={HEADER:"thead",FOOTER:"tfoot"};return e.component("virtual-list",{props:T,data:function(){return{range:null}},watch:{"dataSources.length":function(){this.virtual.updateParam("uniqueIds",this.getUniqueIdFromDataSources()),this.virtual.handleDataSourcesChange()},keeps:function(e){this.virtual.updateParam("keeps",e),this.virtual.handleSlotSizeChange()},start:function(e){this.scrollToIndex(e)},offset:function(e){this.scrollToOffset(e)}},created:function(){this.isHorizontal="horizontal"===this.direction,this.directionKey=this.isHorizontal?"scrollLeft":"scrollTop",this.installVirtual(),this.$on(D.ITEM,this.onItemResized),(this.$slots.header||this.$slots.footer)&&this.$on(D.SLOT,this.onSlotResized)},activated:function(){this.scrollToOffset(this.virtual.offset)},mounted:function(){this.start?this.scrollToIndex(this.start):this.offset&&this.scrollToOffset(this.offset),this.pageMode&&(this.updatePageModeFront(),document.addEventListener("scroll",this.onScroll,{passive:!1}))},beforeDestroy:function(){this.virtual.destroy(),this.pageMode&&document.removeEventListener("scroll",this.onScroll)},methods:{getSize:function(e){return this.virtual.sizes.get(e)},getSizes:function(){return this.virtual.sizes.size},getOffset:function(){if(this.pageMode)return document.documentElement[this.directionKey]||document.body[this.directionKey];var e=this.$refs.root;return e?Math.ceil(e[this.directionKey]):0},getClientSize:function(){var e=this.isHorizontal?"clientWidth":"clientHeight";if(this.pageMode)return document.documentElement[e]||document.body[e];var t=this.$refs.root;return t?Math.ceil(t[e]):0},getScrollSize:function(){var e=this.isHorizontal?"scrollWidth":"scrollHeight";if(this.pageMode)return document.documentElement[e]||document.body[e];var t=this.$refs.root;return t?Math.ceil(t[e]):0},scrollToOffset:function(e){if(this.pageMode)document.body[this.directionKey]=e,document.documentElement[this.directionKey]=e;else{var t=this.$refs.root;t&&(t[this.directionKey]=e)}},scrollToIndex:function(e){if(e>=this.dataSources.length-1)this.scrollToBottom();else{var t=this.virtual.getOffset(e);this.scrollToOffset(t)}},scrollToBottom:function(){var e=this,t=this.$refs.shepherd;if(t){var n=t[this.isHorizontal?"offsetLeft":"offsetTop"];this.scrollToOffset(n),setTimeout((function(){e.getOffset()+e.getClientSize()<e.getScrollSize()&&e.scrollToBottom()}),3)}},updatePageModeFront:function(){var e=this.$refs.root;if(e){var rect=e.getBoundingClientRect(),t=e.ownerDocument.defaultView,n=this.isHorizontal?rect.left+t.pageXOffset:rect.top+t.pageYOffset;this.virtual.updateParam("slotHeaderSize",n)}},reset:function(){this.virtual.destroy(),this.scrollToOffset(0),this.installVirtual()},installVirtual:function(){this.virtual=new N({slotHeaderSize:0,slotFooterSize:0,keeps:this.keeps,estimateSize:this.estimateSize,buffer:Math.round(this.keeps/3),uniqueIds:this.getUniqueIdFromDataSources()},this.onRangeChanged),this.range=this.virtual.getRange()},getUniqueIdFromDataSources:function(){var e=this.dataKey;return this.dataSources.map((function(t){return"function"==typeof e?e(t):t[e]}))},onItemResized:function(e,t){this.virtual.saveSize(e,t),this.$emit("resized",e,t)},onSlotResized:function(e,t,n){e===w.HEADER?this.virtual.updateParam("slotHeaderSize",t):e===w.FOOTER&&this.virtual.updateParam("slotFooterSize",t),n&&this.virtual.handleSlotSizeChange()},onRangeChanged:function(e){this.range=e},onScroll:function(e){var t=this.getOffset(),n=this.getClientSize(),r=this.getScrollSize();t<0||t+n>r+1||!r||(this.virtual.handleScroll(t),this.emitEvent(t,n,r,e))},emitEvent:function(e,t,n,r){this.$emit("scroll",r,this.virtual.getRange()),this.virtual.isFront()&&this.dataSources.length&&e-this.topThreshold<=0?this.$emit("totop"):this.virtual.isBehind()&&e+t+this.bottomThreshold>=n&&this.$emit("tobottom")},getRenderSlots:function(e){for(var t=[],n=this.range,r=n.start,o=n.end,l=this.dataSources,c=this.dataKey,d=this.itemClass,h=this.itemTag,m=this.itemStyle,f=this.isHorizontal,v=this.extraProps,y=this.dataComponent,O=this.itemScopedSlots,S=this.$scopedSlots&&this.$scopedSlots.item,I=r;I<=o;I++){var N=l[I];if(N){var T="function"==typeof c?c(N):N[c];"string"==typeof T||"number"==typeof T?t.push(e(_,{props:{index:I,tag:h,event:D.ITEM,horizontal:f,uniqueKey:T,source:N,extraProps:v,component:y,slotComponent:S,scopedSlots:O},style:m,class:"".concat(d).concat(this.itemClassAdd?" "+this.itemClassAdd(I):"")})):console.warn("Cannot get the data-key '".concat(c,"' from data-sources."))}else console.warn("Cannot get the index '".concat(I,"' from data-sources."))}return t}},render:function(e){var t=this.$slots,header=t.header,footer=t.footer,n=this.range,r=n.padFront,o=n.padBehind,l=this.isHorizontal,c=this.pageMode,d=this.rootTag,h=this.wrapTag,m=this.wrapClass,f=this.wrapStyle,v=this.headerTag,y=this.headerClass,O=this.headerStyle,S=this.footerTag,I=this.footerClass,N=this.footerStyle,T={padding:l?"0px ".concat(o,"px 0px ").concat(r,"px"):"".concat(r,"px 0px ").concat(o,"px")},E=f?Object.assign({},f,T):T;return e(d,{ref:"root",on:{"&scroll":!c&&this.onScroll}},[header?e(j,{class:y,style:O,props:{tag:v,event:D.SLOT,uniqueKey:w.HEADER}},header):null,e(h,{class:m,attrs:{role:"group"},style:E},this.getRenderSlots(e)),footer?e(j,{class:I,style:N,props:{tag:S,event:D.SLOT,uniqueKey:w.FOOTER}},footer):null,e("div",{ref:"shepherd",style:{width:l?"0px":"100%",height:l?"100%":"0px"}})])}})}(n(0))},802:function(e,t,n){var content=n(1206);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(7).default)("dc0d846e",content,!0,{sourceMap:!1,manualInject:!0})},803:function(e,t,n){var content=n(1211);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(7).default)("1aee52c5",content,!0,{sourceMap:!1,manualInject:!0})},805:function(e,t,n){"use strict";n(1);var r=n(178),o=n(291),l=n(489),c=n(337),d=n(195),h=n(290),m=n(336),f=n(358),v=n(2),y=n(201),O=n(266),S=n(443),I=n(561),N=n(200),T=n(381),E=n(452);class k extends S.a{constructor(data){super(data),this.targetUser={userId:this.userId,orgId:this.orgId,fullName:this.roomName,photoUrl:this.photoUrl,initials:Object(O.a)({firstName:this.firstName,lastName:this.lastName})},this.targetUserId=this.userId,this.targetOrgId=this.orgId}}t.a=()=>{const e=Object(E.c)(),t=new T.c,n=new r.a,O=e=>e.map((e=>e.storyId?new I.a(e):e.roomType===y.a.ONE_ON_ONE?new k(e):new S.a(e))),x=Object(v.l)({loading:{},loadingMore:{},result:{}}),_={},j=Object(v.m)(null);n.pipe(Object(l.a)(200),Object(c.a)((e=>{let[t]=e;return Boolean(t)})),Object(d.a)((e=>{let[t,n]=e;return[t.toLowerCase(),n]})),Object(h.a)((n=>{let[r,l]=n;return j.value===r?Object(o.a)(x.result):(x.loading={},T.d.forEach((section=>{x.loading[section]=!0})),t.search(r,l).pipe(Object(m.a)((t=>{let{items:n,section:section,requestId:r,error:o}=t;const l=o?[]:O(n);x.result={...x.result,[section]:l},x.loading={...x.loading,[section]:!1},_[section]={page:0,requestId:r},e(l).subscribe()})),Object(f.a)((()=>{j.value=r}))))}))).subscribe();const D=new N.a;return Object(v.j)((()=>{n.complete()})),{...Object(v.q)(x),searchQuery:(e,t)=>{n.next([e,t])},searchMore:(section,n)=>{const{page:r,requestId:o}=_[section],l=x.result[section];return x.loadingMore[section]=!0,t.searchMore({query:j.value,roomId:n,page:r+1,section:section,requestId:o}).pipe(Object(m.a)((t=>{const n=O(t),c=l.concat(n);return n.length&&(_[section]={page:r+1,requestId:o},x.result={...x.result,[section]:c},e(n).subscribe()),c})),Object(f.a)((()=>{x.loadingMore[section]=!1})))},getOneOnOneRoom:e=>D.getOneOnOneRoom({userId:e.targetUserId,orgId:e.targetOrgId}),searchMentions:e=>t.browse(e,{includeGroupRooms:!0,includeInterviewRooms:!0,includeContractRooms:!0,includeOneOnOneRooms:!0,includeCompanyContacts:!0,includeOtherContacts:!0,includeSubscribedPublicRooms:!0,includeSubscribedPrivateRooms:!1,includeUnsubscribedPublicRooms:!0}).pipe(Object(d.a)((e=>{let{items:t}=e;const n=Object.values(t.reduce(((e,t)=>(e[t.roomId]=t,e)),{}));return O(n.sort(((e,t)=>-1*e.roomTypeName.localeCompare(t.roomTypeName))))})))}}},806:function(e,t,n){"use strict";n(615)},807:function(e,t,n){var r=n(6)(!1);r.push([e.i,".search-story[data-v-4641f23e]{display:flex;align-items:center;color:var(--text-dark-on-body);text-decoration:none;width:100%;box-sizing:border-box;cursor:pointer;padding:10px 15px;border:var(--border);border-radius:5px;margin-bottom:10px}.search-story.nuxt-link-active[data-v-4641f23e]{background-color:var(--gray-90)}.pointer-events-none[data-v-4641f23e]{pointer-events:none}.story-body[data-v-4641f23e]{display:block;flex-grow:1;width:0;margin-left:10px;position:relative}.person-avatar[data-v-4641f23e]{align-self:flex-start}.story-user-name[data-v-4641f23e]{font-weight:var(--font-weight-strong)}.story-details[data-v-4641f23e]{display:flex;width:100%;font-size:12px}.story-details .story-room-name[data-v-4641f23e],.story-details .story-timestamp[data-v-4641f23e]{min-width:50%;flex-grow:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.story-details .story-room-name[data-v-4641f23e]{color:var(--text-light-on-body)}.story-details .story-timestamp[data-v-4641f23e]{align-self:flex-end;color:var(--text-muted);font-weight:100}.up-d-message[data-v-4641f23e]{overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:var(--font-weight-body);color:var(--text-dark-on-body);margin-bottom:5px;height:35px}.up-d-message[data-v-4641f23e] p{line-height:16px;-webkit-line-clamp:2;-webkit-box-orient:vertical;display:-webkit-box;white-space:normal;word-break:break-all}.up-d-message.message-skeleton[data-v-4641f23e] p{display:inline;color:transparent;background-color:var(--skeleton-color)}.up-d-message[data-v-4641f23e] strong{font-weight:700}",""]),e.exports=r},808:function(e,t,n){"use strict";n(616)},809:function(e,t,n){var r=n(6)(!1);r.push([e.i,".up-d-message-list[data-v-bbf118e8]{display:flex;flex-direction:column;flex-grow:1;--room-list-item-height:55px;overflow-y:auto;margin-top:10px}.story-item[data-v-bbf118e8]{margin-bottom:10px}section[data-v-bbf118e8]{display:flex;flex-direction:column;flex-grow:1}section.message[data-v-bbf118e8]{padding:0 15px;flex-grow:1}.up-d-empty-state[data-v-bbf118e8]{height:auto;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.up-d-search-messages[data-v-bbf118e8]{flex:1}",""]),e.exports=r},811:function(e,t,n){"use strict";var r=n(157),o=n(568),l=n(338),c=n(265),d=n(2),h=n(183),m=n(561),f=n(213),v=n(283),y=n(309),O=n(302),S=n(699),I=Object(d.c)({props:{story:{type:[m.a,h.a],required:!0},query:String},components:{UpDPersonAvatar:v.a,UpDRoomItemStory:S.a,UpDSkeleton:f.a,UpDMessage:y.default},computed:{roomLink(){return this.story instanceof h.a?{}:{params:{roomId:this.story.roomId,storyId:this.story.storyId},query:{companyReference:this.$auth.orgId,atTimestamp:this.story.created}}},snippet(){if(!this.query)return this.story.message;const e=new RegExp("(".concat(this.query,")"),"ig"),t=this.story.message.replace(/\r?\n|\r/g," "),n=e.exec(t)||{index:0},i=Math.max(n.index-50,0);return(i?"&#8230;":"")+(n.index?t.substr(i,100).replace(/^\S\s/,"").trim():t).replace(e,"**$1**&#8205;")},showSkeleton(){return this.story instanceof h.a},storyDate(){return"".concat(Object(O.a)(this.story.created,{i18n:this.$i18n},!1)," ").concat(Object(O.d)(this.story.created,{i18n:this.$i18n}))}}}),N=I,T=(n(806),n(4)),E=Object(T.a)(N,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("NuxtLink",{staticClass:"search-story",class:{"pointer-events-none":e.showSkeleton},attrs:{to:e.roomLink,"active-class":e.showSkeleton?"no-active":null}},[n("up-d-person-avatar",{staticClass:"person-avatar",attrs:{person:e.story.user,"is-public":Boolean(e.story.isPublic),"show-skeleton":e.showSkeleton,"avatar-size":30}}),e._v(" "),n("div",{staticClass:"story-body"},[n("up-d-skeleton",{attrs:{loading:e.showSkeleton}},[e.story.user?n("div",{staticClass:"story-user-name"},[e._v("\n          "+e._s(e.story.user.fullName)+"\n        ")]):e._e()]),e._v(" "),n("up-d-message",{staticClass:"up-d-message",class:{"message-skeleton":e.showSkeleton},attrs:{value:e.snippet}}),e._v(" "),n("up-d-skeleton",{staticClass:"story-details",attrs:{loading:e.showSkeleton}},[n("div",{staticClass:"story-details"},[e.story.roomName?n("div",{staticClass:"story-room-name"},[e._v("\n            "+e._s(e.story.roomName)+"\n          ")]):e._e(),e._v(" "),e.story.created?n("div",{staticClass:"story-timestamp text-right"},[e._v("\n            "+e._s(e.storyDate)+"\n          ")]):e._e()])])],1)],1)],1)}),[],!1,null,"4641f23e",null).exports,k={name:"UpDMessageList",props:{query:String,loading:Boolean,stories:Array},components:{UpCIcon:r.default,SearchStory:E,UpDEmptyState:c.a},mixins:[o.a],watch:{stories(e){e.length>0&&this.$nextTick((()=>{this.startScroll(),this.observeLastItem()}))}},data:()=>({skeletonStories:Object(l.d)(3,{longMessage:!0})}),computed:{illustrationNoContacts:()=>()=>n.e(91).then(n.bind(null,2335)),isEmpty(){var e;return!(null!==(e=this.stories)&&void 0!==e&&e.length)}},methods:{onScrolledToLastItem(){this.$emit("loadMore")}}},x=(n(808),Object(T.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"up-d-message-list"},[e.loading&&e.isEmpty?n("section",{staticClass:"message"},e._l(e.skeletonStories,(function(e){return n("SearchStory",{key:e.id,staticClass:"story-item",attrs:{story:e}})})),1):n("section",{class:{message:!e.isEmpty}},[e.isEmpty?n("up-d-empty-state",{staticClass:"up-d-empty-state",attrs:{illustration:e.query?e.illustrationNoContacts:null}},[e._t("default")],2):[n("div",{ref:"scroller"},e._l(e.stories,(function(t){return n("SearchStory",{key:t.id,staticClass:"story-item",attrs:{query:e.query,id:t.id,story:t},nativeOn:{click:function(n){return e.$emit("storyClick",t.id)}}})})),1)]],2)])}),[],!1,null,"bbf118e8",null));t.a=x.exports}}]);
//# sourceMappingURL=https://upwork-usw2-staging-assets-jsmaps.s3.us-west-2.amazonaws.com/ThunderNuxt/search-panel.8339b4ee.js.map