(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{1819:function(e){e.exports=JSON.parse('{"thun_ShareYourExperience_477":"Share your experience"}')},1820:function(e){e.exports=JSON.parse('{"thun_ShareYourExperience_477":"Share your experience"}')},1821:function(e){e.exports=JSON.parse('{"thun_ShareYourExperience_477":"[猫Share your experience猫]"}')},2320:function(e,n,t){"use strict";t.r(n);var o=t(2),r=t(564),c=t(230),l=t(51),d=t(485),h=t(229),m=t(330),_=t(433),C=t(184),A=t(487),T={"en-gb":t(1819),en:t(1820),is:t(1821)};const y=(e,n)=>{const{$auth:t}=Object(l.b)(),y=Object(l.a)(T),{room:M}=Object(h.a)(e,t,{}),I=Object(r.a)(e),{myTimezone:S}=Object(c.c)(e,t),{storyActions:k}=Object(m.a)(e),{startCalling:O,joinZoomCall:f,joinOrStartRecordedZoomMeeting:E}=Object(_.a)(e),{openModalDialog:w}=Object(C.a)();return Object(o.r)(M,(e=>I.setTrackerData(e)),{deep:!0}),{onActionEvent:function(o){let{type:r,name:c,link:link,metadata:l}=o;if(t.isSudo)return void("calendar:meeting"!==r&&"zoom:meeting"!==r&&window.open(link,"_blank"));if("zoom:meeting"===r)return void function(n,link){switch(n){case A.b.ShareFeedback:w({title:y.t("thun_ShareYourExperience_477"),name:"room-call-feedback",params:{roomId:e},query:{call_type:"zoom",room_type:M.value.roomType,contract_id:M.value.contractId,participants:M.value.numUsers,contractor_uid:M.value.targetUserId}});break;case A.b.JoinZoomMeeting:f(link);break;case A.b.DialInByPhone:O("phone")}}(c,link);if("calendar:meeting"===r)return void async function(e,t){switch(e){case A.a.PickADateAndTime:!function(e){I.openBookingModal({slug:e.slug})}(t);break;case A.a.Reschedule:!function(e){I.openRescheduleModal({slug:e.pageSlug,commonId:e.commonId})}(t);break;case A.a.Cancel:!function(e){I.openCancelMeetingModal({timezoneArea:S.value,commonId:e.commonId})}(t);break;case A.a.AddToCalendar:!function(e){I.openAddMeetingModal({commonId:e.commonId})}(t);break;case A.a.JoinTheMeeting:try{await E()}catch(e){n.emit("error",{errorMessage:e.message})}}}(c,l);if("zoom:recording"===r)return void Object(d.a)(l.password);const h=k.value.find((e=>{let{id:n}=e;return n===r}));h?h.callback({name:c,link:link,metadata:l}):link&&window.open(link,"_blank")}}};var M=Object(o.c)({props:{roomId:{type:String,required:!1}},setup(e,n){if(!e.roomId)return{onActionEvent:()=>{}};const{onActionEvent:t}=y(e.roomId,n);return{onActionEvent:t}},render:()=>null}),I=t(4),component=Object(I.a)(M,undefined,undefined,!1,null,null,null);n.default=component.exports},331:function(e,n,t){"use strict";t.d(n,"b",(function(){return l})),t.d(n,"d",(function(){return m})),t.d(n,"a",(function(){return _}));t(1);var o=t(2),r=t(249),c=t(203);const l={GOOGLE:"gmail",MICROSOFT:"outlook"},d={[l.GOOGLE]:"Google",[l.MICROSOFT]:"Microsoft"},h={[l.GOOGLE]:["gmail"],[l.MICROSOFT]:["exchange","outlook","hotmail","eas","office365"]};function m(e){return d[e]||e}const _={ACTIVE:0,INVALID:1,STOPPED:2,DELETED:3,SYNCING:4};n.c=()=>{const e=new r.a,n=Object(o.l)({isConnected:!1,calendarAccountId:null,nylasAuthUrl:null,connectedEmail:null,isVirtualCalendar:!1});return{...Object(o.q)(n),getAccount:async()=>{try{const t=await e.getAccount();n.isConnected=(null==t?void 0:t.status)===_.ACTIVE,n.isConnected&&(n.connectedEmail=t.email,n.isVirtualCalendar=!!t.virtualCalendar,n.calendarAccountId=t.accountId)}catch(e){throw await Object(c.b)(e)}},getAuthUrl:async()=>{try{const{url:t}=await e.getAuthUrl();n.nylasAuthUrl=new URL(t)}catch(e){throw await Object(c.b)(e)}},disconnectAccount:async t=>{try{await e.disconnectAccount(t),e.removeCachedPages(),n.isConnected=!1,n.connectedEmail="",n.isVirtualCalendar=!1}catch(e){throw await Object(c.b)(e)}},createAccount:async n=>{try{return await e.createAccount(n)}catch(e){throw await Object(c.b)(e)}},validateEmail:async(t,o)=>{const r={isUnknownProvider:!1,providerName:"",error:null};try{var l;const c=[];c.push(e.getEmailProvider({email:t})),n.isVirtualCalendar&&n.connectedEmail===t||c.push(e.validateEmail({email:t}));const[m,_]=await Promise.all(c);return r.providerName=null==m?void 0:m.name,_&&!_.result?r.error="This email is already connected with another Upwork profile.":"unknown"===r.providerName?r.isUnknownProvider=!0:null!==(l=h[o])&&void 0!==l&&l.includes(r.providerName)||(r.error="It looks like that email isn’t connected to a ".concat(d[o]," account.")),r}catch(e){throw await Object(c.b)(e)}}}}},332:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));const o={EDIT_AVAILABILITY:"editAvailability",CALENDAR_STATUS:"calendarStatus",CONNECT_CALENDAR:"connectCalendar",SCHEDULE_NEW:"scheduleNew",ADD_TO_CALENDAR:"addToCalendar"}},378:function(e,n,t){"use strict";var o=t(51);n.a=()=>{const{$thunderTracker:e}=Object(o.b)();return{track(n,t,label){let{roomId:o,contractId:r,numUsers:c,roomTypeName:l,reason:d,roomTypeExtended:h}=n;e.track({event:t,sublocation:"meeting_scheduler",label:label,data:{room_id:o,contract_id:r,room_type:l,room_type_extended:h,participants:c,reason:d}})}}}},546:function(e){e.exports=JSON.parse('{"thun_UnableToScheduleTheMeetingPleaseTryAgain_507":"Unable to schedule the meeting. Please try again","thun_ConnectYourCalendar_508":"Connect your calendar","thun_ChooseYourMeetingLength_509":"Choose your meeting length","thun_WhenAreYouFreeForMeetings_510":"When are you free for meetings?","thun_ChooseADateAndTime_511":"Choose a date and time","thun_TheMeetingWasScheduled_512":"The meeting was scheduled","thun_CancelMeeting_513":"Cancel meeting","thun_AddThisMeetingToYourCalendar_514":"Add this meeting to your calendar","thun_TheMeetingWasRescheduled_515":"The meeting was rescheduled","thun_UnableToRescheduleTheMeetingPleaseTryAga_516":"Unable to reschedule the meeting. Please try again","thun_YourCalendarIsSyncing_517":"Your calendar is syncing","thun_CalendarConnectionIssue_518":"Calendar connection issue"}')},547:function(e){e.exports=JSON.parse('{"thun_UnableToScheduleTheMeetingPleaseTryAgain_507":"Unable to schedule the meeting. Please try again","thun_ConnectYourCalendar_508":"Connect your calendar","thun_ChooseYourMeetingLength_509":"Choose your meeting length","thun_WhenAreYouFreeForMeetings_510":"When are you free for meetings?","thun_ChooseADateAndTime_511":"Choose a date and time","thun_TheMeetingWasScheduled_512":"The meeting was scheduled","thun_CancelMeeting_513":"Cancel meeting","thun_AddThisMeetingToYourCalendar_514":"Add this meeting to your calendar","thun_TheMeetingWasRescheduled_515":"The meeting was rescheduled","thun_UnableToRescheduleTheMeetingPleaseTryAga_516":"Unable to reschedule the meeting. Please try again","thun_YourCalendarIsSyncing_517":"Your calendar is syncing","thun_CalendarConnectionIssue_518":"Calendar connection issue"}')},548:function(e){e.exports=JSON.parse('{"thun_UnableToScheduleTheMeetingPleaseTryAgain_507":"[猫Unable to schedule the meeting. Please try again猫]","thun_ConnectYourCalendar_508":"[猫Connect your calendar猫]","thun_ChooseYourMeetingLength_509":"[猫Choose your meeting length猫]","thun_WhenAreYouFreeForMeetings_510":"[猫When are you free for meetings?猫]","thun_ChooseADateAndTime_511":"[猫Choose a date and time猫]","thun_TheMeetingWasScheduled_512":"[猫The meeting was scheduled猫]","thun_CancelMeeting_513":"[猫Cancel meeting猫]","thun_AddThisMeetingToYourCalendar_514":"[猫Add this meeting to your calendar猫]","thun_TheMeetingWasRescheduled_515":"[猫The meeting was rescheduled猫]","thun_UnableToRescheduleTheMeetingPleaseTryAga_516":"[猫Unable to reschedule the meeting. Please try again猫]","thun_YourCalendarIsSyncing_517":"[猫Your calendar is syncing猫]","thun_CalendarConnectionIssue_518":"[猫Calendar connection issue猫]"}')},564:function(e,n,t){"use strict";var o=t(2),r=t(51),c=t(161),l=t(378),d=t(331),h=t(332),m=t(215),_=t(184),C={"en-gb":t(546),en:t(547),is:t(548)};const A="schedule",T="meetingStory",y=Symbol("SchedulerContext");n.a=e=>{if(Object(o.e)(y,null))return Object(o.e)(y);const{openModalDialog:n}=Object(_.a)(),{disconnectAccount:M}=Object(d.c)(),{$isNativeApp:I}=Object(r.b)(),S=Object(r.e)(),k=Object(r.a)(C),O=Object(l.a)(),f=Object(o.m)(),E=Object(m.a)();let w=null;const v={};let D,N={};f.value=!1;const U={isLoading:f,setTrackerData(n){let{contractId:t,roomTypeName:o,numUsers:r,roomTypeExtended:c}=n;N={roomId:e,contractId:t,roomTypeName:o,numUsers:r,roomTypeExtended:c}},async scheduleMeeting(n){const o=await async function(e){try{const{default:n}=await t.e(364).then(t.bind(null,831));return D=n(),f.value=!0,await D.loadSchedulingPages(e).toPromise()}catch(e){S.createToaster({type:"danger",content:k.t("thun_UnableToScheduleTheMeetingPleaseTryAgain_507")})}finally{f.value=!1}return null}(n);if(null!=o&&o.length)this.openSchedulerModal(o);else{const n=await D.getAccountStatus();n===d.a.SYNCING?this.openCalendarStatusModal():n===d.a.STOPPED||n===d.a.INVALID?(await M(e),this.openCalendarStatusModal(!1)):(w=A,this.openConnectModal())}},openConnectModal(){let{openFromScheduler:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n({title:k.t("thun_ConnectYourCalendar_508"),name:"scheduler-connect-calendar",params:{roomId:e},data:{...N,schedulerAction:w===T?h.a.CONNECT_CALENDAR:h.a.EDIT_AVAILABILITY}}).then((e=>{let{closeModal:n,schedulerAction:o}=e,r=o;n&&t?r=h.a.SCHEDULE_NEW:n&&w===T&&(r=h.a.ADD_TO_CALENDAR),this.handleModalResponse("scheduler-connect-calendar",{schedulerAction:r})}))},openSchedulerModal(t){return O.track(N,"click","schedule_a_meeting_header"),n({title:k.t("thun_ChooseYourMeetingLength_509"),name:"room-scheduler",params:{roomId:e},data:{schedulingPages:t,...N}}).then((e=>{w=A,this.handleModalResponse("room-scheduler",e)}))},openAvailabilityModal(t){return t&&(w=A),n({name:"room-scheduler-availability",title:k.t("thun_WhenAreYouFreeForMeetings_510"),params:{roomId:e}}).then((()=>{this.handleModalResponse("room-scheduler-availability",{schedulerAction:w===A?h.a.SCHEDULE_NEW:void 0})}))},openBookingModal(t){let{slug:o}=t;return O.track(N,"click","select_time_date"),n({title:k.t("thun_ChooseADateAndTime_511"),name:"scheduler-booking-modal",params:{roomId:e},query:{slug:o}}).then((e=>{let{confirmed:n,cancelled:t}=e;n?(O.track(N,"click","confirm_booking"),S.createToaster({type:"success",content:k.t("thun_TheMeetingWasScheduled_512")})):t&&O.track(N,"click","cancel_select_time_date")})).catch((e=>{S.createToaster({type:"danger",duration:0,content:e.message||k.t("thun_UnableToScheduleTheMeetingPleaseTryAgain_507")})}))},openCancelMeetingModal(t){let{timezoneArea:o,commonId:r}=t;return O.track(N,"click","cancel_meeting"),n({title:k.t("thun_CancelMeeting_513"),name:"scheduler-cancel-meeting",params:{roomId:e},data:{timezoneArea:o,commonId:r}}).then((e=>{let{reason:n}=e;O.track({reason:n,...this.trackerData},"click","confirm_cancel")}))},openAddMeetingModal(t){let{commonId:o}=t;return O.track(N,"click","add_meeting"),n({title:k.t("thun_AddThisMeetingToYourCalendar_514"),name:"scheduler-add-meeting",params:{roomId:e},data:{commonId:o}}).then((e=>{w=T,v.commonId=o,this.handleModalResponse("scheduler-add-meeting",e)}))},openRescheduleModal(t){let{slug:o,commonId:r}=t;return O.track(N,"click","reschedule_meeting"),n({title:k.t("thun_ChooseADateAndTime_511"),name:"scheduler-booking-modal",params:{roomId:e},query:{slug:o,commonId:r}}).then((e=>{let{confirmed:n}=e;n&&(O.track(N,"click","confirm_reschedule"),S.createToaster({type:"success",content:k.t("thun_TheMeetingWasRescheduled_515")}))})).catch((e=>{S.createToaster({type:"danger",duration:0,content:e.message||k.t("thun_UnableToRescheduleTheMeetingPleaseTryAga_516")})}))},openCalendarStatusModal(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n({title:t?k.t("thun_YourCalendarIsSyncing_517"):k.t("thun_CalendarConnectionIssue_518"),name:"scheduler-calendar-status",params:{roomId:e},data:{isSyncing:t}}).then((()=>{t||(w=A,this.openConnectModal())}))},handleModalResponse(e,n){let{schedulerAction:t}=n;setTimeout((()=>{switch(t){case h.a.EDIT_AVAILABILITY:this.openAvailabilityModal();break;case h.a.CONNECT_CALENDAR:this.openConnectModal({openFromScheduler:"room-scheduler"===e});break;case h.a.SCHEDULE_NEW:this.scheduleMeeting(c.b.CacheFirst);break;case h.a.CALENDAR_STATUS:this.openCalendarStatusModal();break;case h.a.ADD_TO_CALENDAR:this.openAddMeetingModal(v);break;default:E.warn("Unknown 'schedulerAction' modal response: [".concat(t,"]"))}}),I?1e3:300)}};return Object(o.k)(y,U),U}}}]);
//# sourceMappingURL=https://upwork-usw2-staging-assets-jsmaps.s3.us-west-2.amazonaws.com/ThunderNuxt/StoryRefActionHandler-TjmHD.4f46fac1.js.map