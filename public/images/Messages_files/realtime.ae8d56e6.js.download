(window.webpackJsonp=window.webpackJsonp||[]).push([[321],{1806:function(e,t,n){e.exports=n(1807)},1807:function(e,t,n){var o,r;o=function(){"use strict";var e,t,n={},o=!1,r=[],c=[],l=0;return Object.prototype.hasOwnProperty,(n={version:"3.1.3-javascript",onError:function(e){},onClose:function(e){},onOpen:function(e){},onReopen:function(e){},onMessage:function(e){},onReconnect:function(e,t){},onMessagePublished:function(e){},onTransportFailure:function(e,t){},onLocalMessage:function(e){},onFailureToReconnect:function(e,t){},onClientTimeout:function(e){},onOpenAfterResume:function(e){},WebsocketApiAdapter:function(e){var t,o;return e.onMessage=function(e){o.onmessage({data:e.responseBody})},e.onMessagePublished=function(e){o.onmessage({data:e.responseBody})},e.onOpen=function(e){o.onopen(e)},o={close:function(){t.close()},send:function(data){t.push(data)},onmessage:function(e){},onopen:function(e){},onclose:function(e){},onerror:function(e){}},t=new n.subscribe(e),o},AtmosphereRequest:function(e){var t,r,d,h={timeout:3e5,method:"GET",headers:{},contentType:"",callback:null,url:"",data:"",suspend:!0,maxRequest:-1,reconnect:!0,maxStreamingLength:1e7,lastIndex:0,logLevel:"info",requestCount:0,fallbackMethod:"GET",fallbackTransport:"streaming",transport:"long-polling",webSocketImpl:null,webSocketBinaryType:null,dispatchUrl:null,webSocketPathDelimiter:"@@",enableXDR:!1,rewriteURL:!1,attachHeadersAsQueryString:!0,executeCallbackBeforeReconnect:!1,readyState:0,withCredentials:!1,trackMessageLength:!1,messageDelimiter:"|",connectTimeout:-1,reconnectInterval:0,dropHeaders:!0,uuid:0,shared:!1,readResponsesHeaders:!1,maxReconnectOnClose:5,enableProtocol:!0,disableDisconnect:!1,pollingInterval:0,heartbeat:{client:null,server:null},ackInterval:0,reconnectOnServerError:!0,handleOnlineOffline:!0,maxWebsocketErrorRetries:1,curWebsocketErrorRetries:0,unloadBackwardCompat:!navigator.sendBeacon,onError:function(e){},onClose:function(e){},onOpen:function(e){},onMessage:function(e){},onReopen:function(e,t){},onReconnect:function(e,t){},onMessagePublished:function(e){},onTransportFailure:function(e,t){},onLocalMessage:function(e){},onFailureToReconnect:function(e,t){},onClientTimeout:function(e){},onOpenAfterResume:function(e){}},f={status:200,reasonPhrase:"OK",responseBody:"",messages:[],headers:[],state:"messageReceived",transport:"polling",error:null,request:null,partialMessage:"",errorHandled:!1,closedByClientTimeout:!1,ffTryingReconnect:!1},m=null,v=null,w=null,C=null,y=null,k=!0,S=0,T=0,I="X",R=!1,O=null,x=null,_=n.util.now();function E(){k=!0,R=!1,S=0,m=null,v=null,w=null,C=null}function M(){P(),E()}function F(e){return"debug"==e?"debug"===h.logLevel:"info"==e?"info"===h.logLevel||"debug"===h.logLevel:"warn"==e?"warn"===h.logLevel||"info"===h.logLevel||"debug"===h.logLevel:"error"==e&&("error"===h.logLevel||"warn"===h.logLevel||"info"===h.logLevel||"debug"===h.logLevel)}function A(e){F("debug")&&n.util.debug(new Date+" Atmosphere: "+e)}function L(e,t){return""===f.partialMessage&&"streaming"===t.transport&&e.responseText.length>t.maxStreamingLength}function N(){if(h.enableProtocol&&!h.disableDisconnect&&!h.firstMessage){var e="X-Atmosphere-Transport=close&X-Atmosphere-tracking-id="+h.uuid;n.util.each(h.headers,(function(t,o){var r=n.util.isFunction(o)?o.call(this,h,h,f):o;null!=r&&(e+="&"+encodeURIComponent(t)+"="+encodeURIComponent(r))}));var t=h.url.replace(/([?&])_=[^&]*/,e);t+=t===h.url?(/\?/.test(h.url)?"&":"?")+e:"";var o={connected:!1},r=new n.AtmosphereRequest(o);r.connectTimeout=h.connectTimeout,r.attachHeadersAsQueryString=!1,r.dropHeaders=!0,r.url=t,r.contentType="text/plain",r.transport="polling",r.method="GET",r.data="",r.heartbeat=null,h.enableXDR&&(r.enableXDR=h.enableXDR),Ce("",r)}}function D(){A("Closing (AtmosphereRequest._close() called)"),R=!0,h.reconnectId&&(clearTimeout(h.reconnectId),delete h.reconnectId),h.heartbeatTimer&&clearTimeout(h.heartbeatTimer),h.reconnect=!1,f.request=h,f.state="unsubscribe",f.responseBody="",f.status=408,f.partialMessage="",h.curWebsocketErrorRetries=0,Le(),N(),P()}function P(){f.partialMessage="",h.id&&clearTimeout(h.id),h.heartbeatTimer&&clearTimeout(h.heartbeatTimer),h.reconnectId&&(clearTimeout(h.reconnectId),delete h.reconnectId),null!=C&&(C.close(),C=null),null!=y&&(y.abort(),y=null),null!=w&&(w.abort(),w=null),null!=m&&(m.canSendMessage&&(A("invoking .close() on WebSocket object"),m.close()),m=null),null!=v&&(v.close(),v=null),B()}function B(){null!=t&&(clearInterval(r),document.cookie=d+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",t.signal("close",{reason:"",heir:R?(t.get("children")||[])[0]:_}),t.close()),null!=x&&x.close()}function U(e){M(),(h=n.util.extend(h,e)).mrequest=h.reconnect,h.reconnect||(h.reconnect=!0)}function j(){return null!=h.webSocketImpl||window.WebSocket||window.MozWebSocket}function H(){var e=n.util.getAbsoluteURL(h.url.toLowerCase()),t=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/.exec(e),o=!(!t||t[1]==window.location.protocol&&t[2]==window.location.hostname&&(t[3]||("http:"===t[1]?80:443))==(window.location.port||("http:"===window.location.protocol?80:443)));return window.EventSource&&(!o||!n.util.browser.safari||n.util.browser.vmajor>=7)}function X(){if(h.shared){if(null!=(x=J(h))&&(F("debug")&&n.util.debug("Storage service available. All communication will be local"),x.open(h)))return;F("debug")&&n.util.debug("No Storage service available."),x=null}h.firstMessage=0==l,h.isOpen=!1,h.ctime=n.util.now(),0===h.uuid&&(h.uuid=l),f.closedByClientTimeout=!1,"websocket"!==h.transport&&"sse"!==h.transport?le(h):"websocket"===h.transport?j()?Z(!1):se("Websocket is not supported, using request.fallbackTransport ("+h.fallbackTransport+")"):"sse"===h.transport&&(H()?K(!1):se("Server Side Events(SSE) is not supported, using request.fallbackTransport ("+h.fallbackTransport+")"))}function J(e){var t,o,c,l="atmosphere-"+e.url,d={storage:function(){function t(e){e.key===l&&e.newValue&&m(e.newValue)}if(n.util.storage){var o=window.localStorage,r=function(e){var t=o.getItem(l+"-"+e);return null===t?[]:JSON.parse(t)},c=function(e,t){o.setItem(l+"-"+e,JSON.stringify(t))};return{init:function(){return c("children",r("children").concat([_])),n.util.on(window,"storage",t),r("opened")},signal:function(e,data){o.setItem(l,JSON.stringify({target:"p",type:e,data:data}))},close:function(){var o=r("children");n.util.off(window,"storage",t),o&&f(o,e.id)&&c("children",o)}}}},windowref:function(){var e=window.open("",l.replace(/\W/g,""));if(e&&!e.closed&&e.callbacks)return{init:function(){return e.callbacks.push(m),e.children.push(_),e.opened},signal:function(t,data){!e.closed&&e.fire&&e.fire(JSON.stringify({target:"p",type:t,data:data}))},close:function(){c||(f(e.callbacks,m),f(e.children,_))}}}};function f(e,t){var i,n=e.length;for(i=0;i<n;i++)e[i]===t&&e.splice(i,1);return n!==e.length}function m(t){var n=JSON.parse(t),data=n.data;if("c"===n.target)switch(n.type){case"open":z("opening","local",h);break;case"close":c||(c=!0,"aborted"===data.reason?D():data.heir===_?X():setTimeout((function(){X()}),100));break;case"message":Ee(data,"messageReceived",200,e.transport);break;case"localMessage":_e(data)}}function v(){var e=new RegExp("(?:^|; )("+encodeURIComponent(l)+")=([^;]*)").exec(document.cookie);if(e)return JSON.parse(decodeURIComponent(e[2]))}if((t=v())&&!(n.util.now()-t.ts>1e3)&&(o=d.storage()||d.windowref()))return{open:function(){var n;return r=setInterval((function(){var e=t;(t=v())&&e.ts!==t.ts||m(JSON.stringify({target:"c",type:"close",data:{reason:"error",heir:e.heir}}))}),1e3),(n=o.init())&&setTimeout((function(){z("opening","local",e)}),50),n},send:function(e){o.signal("send",e)},localSend:function(e){o.signal("localSend",JSON.stringify({id:_,event:e}))},close:function(){R||(clearInterval(r),o.signal("close"),o.close())}}}function W(){var e,o="atmosphere-"+h.url,c={storage:function(){function e(e){e.key===o&&e.newValue&&l(e.newValue)}if(n.util.storage){var t=window.localStorage;return{init:function(){n.util.on(window,"storage",e)},signal:function(e,data){t.setItem(o,JSON.stringify({target:"c",type:e,data:data}))},get:function(e){return JSON.parse(t.getItem(o+"-"+e))},set:function(e,n){t.setItem(o+"-"+e,JSON.stringify(n))},close:function(){n.util.off(window,"storage",e),t.removeItem(o),t.removeItem(o+"-opened"),t.removeItem(o+"-children")}}}},windowref:function(){var e,t=o.replace(/\W/g,""),n=document.getElementById(t);return n||((n=document.createElement("div")).id=t,n.style.display="none",n.innerHTML='<iframe name="'+t+'"></iframe>',document.body.appendChild(n)),e=n.firstChild.contentWindow,{init:function(){e.callbacks=[l],e.fire=function(t){var i;for(i=0;i<e.callbacks.length;i++)e.callbacks[i](t)}},signal:function(t,data){!e.closed&&e.fire&&e.fire(JSON.stringify({target:"c",type:t,data:data}))},get:function(t){return e.closed?null:e[t]},set:function(t,n){e.closed||(e[t]=n)},close:function(){}}}};function l(e){var t=JSON.parse(e),data=t.data;if("p"===t.target)switch(t.type){case"send":we(data);break;case"localSend":_e(data);break;case"close":D()}}function f(){document.cookie=d+"="+encodeURIComponent(JSON.stringify({ts:n.util.now()+1,heir:(e.get("children")||[])[0]}))+"; path=/"}O=function(t){e.signal("message",t)},(e=c.storage()||c.windowref()).init(),F("debug")&&n.util.debug("Installed StorageService "+e),e.set("children",[]),null==e.get("opened")||e.get("opened")||e.set("opened",!1),d=encodeURIComponent(o),f(),r=setInterval(f,1e3),t=e}function z(e,n,o){if(h.shared&&"local"!==n&&W(),null!=t&&t.set("opened",!0),o.close=function(){D()},S>0&&"re-connecting"===e)o.isReopen=!0,fe(f);else if(!f.error){f.request=o;var r=f.state;f.state=e;var c=f.transport;f.transport=n;var l=f.responseBody;Le(),f.responseBody=l,f.state=r,f.transport=c}}function Q(e){e.transport="jsonp";var script,t=h;null!=e&&void 0!==e&&(t=e),(y={open:function(){var o="atmosphere"+ ++_;function r(){t.lastIndex=0,t.openId&&clearTimeout(t.openId),t.heartbeatTimer&&clearTimeout(t.heartbeatTimer),t.reconnect&&S++<t.maxReconnectOnClose?(z("re-connecting",t.transport,t),he(y,t,e.reconnectInterval),t.openId=setTimeout((function(){ae(t)}),t.reconnectInterval+1e3)):ne(0,"maxReconnectOnClose reached")}function c(){var n=t.url;null!=t.dispatchUrl&&(n+=t.dispatchUrl);var data=t.data;t.attachHeadersAsQueryString&&(n=ie(t),""!==data&&(n+="&X-Atmosphere-Post-Body="+encodeURIComponent(data)),data="");var head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;(script=document.createElement("script")).src=n+"&jsonpTransport="+o,script.clean=function(){script.clean=script.onerror=script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),2==++e.scriptCount&&(e.scriptCount=1,r())},script.onload=script.onreadystatechange=function(){A("jsonp.onload"),script.readyState&&!/loaded|complete/.test(script.readyState)||script.clean()},script.onerror=function(){A("jsonp.onerror"),e.scriptCount=1,script.clean()},head.insertBefore(script,head.firstChild)}window[o]=function(o){if(A("jsonp.window"),e.scriptCount=0,t.reconnect&&-1===t.maxRequest||t.requestCount++<t.maxRequest){if(t.executeCallbackBeforeReconnect||he(y,t,t.pollingInterval),null!=o&&"string"!=typeof o)try{o=o.message}catch(e){}oe(o,t,f)||Ee(f.responseBody,"messageReceived",200,t.transport),t.executeCallbackBeforeReconnect&&he(y,t,t.pollingInterval),ee(t)}else n.util.log(h.logLevel,["JSONP reconnect maximum try reached "+h.requestCount]),ne(0,"maxRequest reached")},setTimeout((function(){c()}),50)},abort:function(){script&&script.clean&&script.clean()}}).open()}function $(e){return null!=h.webSocketImpl?h.webSocketImpl:window.WebSocket?new WebSocket(e):new MozWebSocket(e)}function G(){return ie(h,n.util.getAbsoluteURL(h.webSocketUrl||h.url)).replace(/^http/,"ws")}function V(){return ie(h)}function K(e){f.transport="sse";var t=V();if(F("debug")&&(n.util.debug("Invoking executeSSE"),n.util.debug("Using URL: "+t)),!e||h.reconnect){try{v=new EventSource(t,{withCredentials:h.withCredentials})}catch(e){return ne(0,e),void se("SSE failed. Downgrading to fallback transport and resending")}h.connectTimeout>0&&(h.id=setTimeout((function(){e||P()}),h.connectTimeout)),v.onopen=function(){A("sse.onopen"),ee(h),F("debug")&&n.util.debug("SSE successfully opened"),h.enableProtocol?h.isReopen&&(h.isReopen=!1,z("re-opening",h.transport,h)):z(e?"re-opening":"opening","sse",h),e=!0,"POST"===h.method&&(f.state="messageReceived",we(h.data))},v.onmessage=function(e){A("sse.onmessage"),ee(h),!h.enableXDR&&window.location.host&&e.origin&&e.origin!==window.location.protocol+"//"+window.location.host?n.util.log(h.logLevel,["Origin was not "+window.location.protocol+"//"+window.location.host]):(f.state="messageReceived",f.status=200,oe(e=e.data,h,f)||(Le(),f.responseBody="",f.messages=[]))},v.onerror=function(){if(A("sse.onerror"),clearTimeout(h.id),h.heartbeatTimer&&clearTimeout(h.heartbeatTimer),!f.closedByClientTimeout)if(qe(e),P(),R)n.util.log(h.logLevel,["SSE closed normally"]);else if(e){if(h.reconnect&&"sse"===f.transport)if(S++<h.maxReconnectOnClose){if(z("re-connecting",h.transport,h),h.reconnectInterval>0){var t=h.handleOnlineOffline;h.handleOnlineOffline=!1,h.reconnectId=setTimeout((function(){h.handleOnlineOffline=t,K(!0)}),h.reconnectInterval)}else K(!0);f.responseBody="",f.messages=[]}else n.util.log(h.logLevel,["SSE reconnect maximum try reached "+S]),ne(0,"maxReconnectOnClose reached")}else se("SSE failed. Downgrading to fallback transport and resending")}}else null!=v&&P()}function Z(e){f.transport="websocket";var t=G(h.url);F("debug")&&n.util.debug("Invoking executeWebSocket, using URL: "+t),!e||h.reconnect?(m=$(t),null!=h.webSocketBinaryType&&(m.binaryType=h.webSocketBinaryType),h.connectTimeout>0&&(h.id=setTimeout((function(){if(!e){var t={code:1002,reason:"Connection timeout after "+h.connectTimeout+"ms.",wasClean:!1},n=m;try{P()}catch(e){}n.onclose(t)}}),h.connectTimeout)),m.onopen=function(){if(null==m)return this.close(),void("websocket"==h.transport&&D());A("websocket.onopen"),(!h.enableProtocol||h.connectTimeout<=0)&&ee(h),o=!1,F("debug")&&n.util.debug("Websocket successfully opened");var t=e;m.canSendMessage=!0,h.enableProtocol||(e=!0,z(t?"re-opening":"opening","websocket",h)),"POST"===h.method&&(f.state="messageReceived",m.send(h.data))},m.onmessage=function(t){if(null==m)return this.close(),void("websocket"==h.transport&&D());if(A("websocket.onmessage"),ee(h),h.enableProtocol&&(e=!0),f.state="messageReceived",f.status=200,"string"==typeof(t=t.data))oe(t,h,f)||(Le(),f.responseBody="",f.messages=[]);else{if(""===(t=Y(h,t)))return;f.responseBody=t,Le(),f.responseBody=null}},m.onerror=function(){A("websocket.onerror"),clearTimeout(h.id),h.heartbeatTimer&&clearTimeout(h.heartbeatTimer),f.error=!0},m.onclose=function(t){if(A("websocket.onclose"),"websocket"===f.transport&&(clearTimeout(h.id),"closed"!==f.state)){var r=t.reason;if(""===r)switch(t.code){case 1e3:r="Normal closure; the connection successfully completed whatever purpose for which it was created.";break;case 1001:r="The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.";break;case 1002:r="The endpoint is terminating the connection due to a protocol error.";break;case 1003:r="The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data).";break;case 1004:r="The endpoint is terminating the connection because a data frame was received that is too large.";break;case 1005:r="Unknown: no status code was provided even though one was expected.";break;case 1006:r="Connection was closed abnormally (that is, with no close frame being sent)."}F("warn")&&n.util.warn("Websocket closed, reason: "+r+" - wasClean: "+t.wasClean),f.closedByClientTimeout||h.handleOnlineOffline&&o?h.reconnectId&&(clearTimeout(h.reconnectId),delete h.reconnectId):(qe(e),f.state="closed",R?n.util.log(h.logLevel,["Websocket closed normally"]):f.error&&h.curWebsocketErrorRetries<h.maxWebsocketErrorRetries&&S+1<h.maxReconnectOnClose?(f.error=!1,h.curWebsocketErrorRetries++,re()):!f.error&&e&&0!==h.maxWebsocketErrorRetries||"websocket"===h.fallbackTransport?h.reconnect&&re():(f.error=!1,se("Websocket failed on first connection attempt. Downgrading to "+h.fallbackTransport+" and resending")))}},navigator.userAgent.toLowerCase().indexOf("android")>-1&&void 0===m.url&&m.onclose({reason:"Android 4.1 does not support websockets.",wasClean:!1})):null!=m&&P()}function Y(e,t){var o=t;if("polling"===e.transport)return o;if(e.enableProtocol&&e.firstMessage&&0!==n.util.trim(t).length){var r=e.trackMessageLength?1:0,c=t.split(e.messageDelimiter);if(c.length<=r+1)return o;if(e.firstMessage=!1,e.uuid=n.util.trim(c[r]),c.length<=r+2&&n.util.log("error",["Protocol data not sent by the server. If you enable protocol on client side, be sure to install JavascriptProtocol interceptor on server side.Also note that atmosphere-runtime 2.2+ should be used."]),T=parseInt(n.util.trim(c[r+1]),10),I=c[r+2],"long-polling"!==e.transport&&ae(e),l=e.uuid,o="",r=e.trackMessageLength?4:3,c.length>r+1)for(var i=r;i<c.length;i++)o+=c[i],i+1!==c.length&&(o+=e.messageDelimiter);0!==e.ackInterval&&setTimeout((function(){we("...ACK...")}),e.ackInterval)}else e.enableProtocol&&e.firstMessage&&n.util.browser.msie&&+n.util.browser.version.split(".")[0]<10?n.util.log(h.logLevel,["Receiving unexpected data from IE"]):ae(e);return o}function ee(e){clearTimeout(e.id),e.timeout>0&&"polling"!==e.transport&&(e.id=setTimeout((function(){te(e),N(),P()}),e.timeout))}function te(e){f.closedByClientTimeout=!0,f.state="closedByClient",f.responseBody="",f.status=408,f.messages=[],Le()}function ne(code,e){P(),clearTimeout(h.id),f.state="error",f.reasonPhrase=e,f.responseBody="",f.status=code,f.messages=[],Le()}function oe(e,t,n){if(0===(e=Y(t,e)).length)return!0;if(n.responseBody=e,t.trackMessageLength){var o=[],r=(e=n.partialMessage+e).indexOf(t.messageDelimiter);if(-1!=r){for(;-1!==r;){var c=e.substring(0,r),l=+c;if(isNaN(l))throw n.partialMessage="",new Error('message length "'+c+'" is not a number');(r+=t.messageDelimiter.length)+l>e.length?r=-1:(o.push(e.substring(r,r+l)),r=(e=e.substring(r+l,e.length)).indexOf(t.messageDelimiter))}return n.partialMessage=e,0!==o.length?(n.responseBody=o.join(t.messageDelimiter),n.messages=o,!1):(n.responseBody="",n.messages=[],!0)}}return n.responseBody=e,n.messages=[e],!1}function re(){if(P(),S++<h.maxReconnectOnClose)if(z("re-connecting",h.transport,h),h.reconnectInterval>0){var e=h.handleOnlineOffline;h.handleOnlineOffline=!1,h.reconnectId=setTimeout((function(){h.handleOnlineOffline=e,f.responseBody="",f.messages=[],Z(!0)}),h.reconnectInterval)}else f.responseBody="",f.messages=[],Z(!0);else n.util.log(h.logLevel,["Websocket reconnect maximum try reached "+S]),ne(0,"maxReconnectOnClose reached")}function se(e){if(n.util.log(h.logLevel,[e]),P(),void 0!==h.onTransportFailure?h.onTransportFailure(e,h):void 0!==n.util.onTransportFailure&&n.util.onTransportFailure(e,h),h.reconnect&&"none"!==h.transport||null==h.transport)if(h.transport=h.fallbackTransport,h.method=h.fallbackMethod,f.transport=h.fallbackTransport,f.state="",h.fallbackTransport="none",h.reconnectInterval>0){var t=h.handleOnlineOffline;h.handleOnlineOffline=!1,h.reconnectId=setTimeout((function(){h.handleOnlineOffline=t,X()}),h.reconnectInterval)}else X();else ne(500,"Unable to reconnect with fallback transport")}function ie(e,t){var o=h;return null!=e&&void 0!==e&&(o=e),null==t&&(t=o.url),o.attachHeadersAsQueryString?(-1!==t.indexOf("X-Atmosphere-Framework")||(t+=-1!==t.indexOf("?")?"&":"?",t+="X-Atmosphere-tracking-id="+o.uuid,t+="&X-Atmosphere-Framework="+n.version,t+="&X-Atmosphere-Transport="+o.transport,o.trackMessageLength&&(t+="&X-Atmosphere-TrackMessageSize=true"),null!==o.heartbeat&&null!==o.heartbeat.server&&(t+="&X-Heartbeat-Server="+o.heartbeat.server),""!==o.contentType&&(t+="&Content-Type="+("websocket"===o.transport?o.contentType:encodeURIComponent(o.contentType))),o.enableProtocol&&(t+="&X-atmo-protocol=true"),n.util.each(o.headers,(function(r,c){var l=n.util.isFunction(c)?c.call(this,o,e,f):c;null!=l&&(t+="&"+encodeURIComponent(r)+"="+encodeURIComponent(l))}))),t):t}function ae(e){if(e.isOpen)if(e.isReopen)e.isReopen=!1,z("re-opening",e.transport,e);else{if("messageReceived"!==f.state||"jsonp"!==e.transport&&"long-polling"!==e.transport)return;pe(f)}else e.isOpen=!0,z("opening",e.transport,e);ce(e)}function ce(e){if(null!=e.heartbeatTimer&&clearTimeout(e.heartbeatTimer),!isNaN(T)&&T>0){var t=function(){F("debug")&&n.util.debug("Sending heartbeat"),we(I),e.heartbeatTimer=setTimeout(t,T)};e.heartbeatTimer=setTimeout(t,T)}}function le(e){var t=h;if(null==e&&void 0===e||(t=e),t.lastIndex=0,t.readyState=0,"jsonp"===t.transport||t.enableXDR&&n.util.checkCORSSupport())Q(t);else{if(n.util.browser.msie&&+n.util.browser.version.split(".")[0]<10){if("streaming"===t.transport)return void(t.enableXDR&&window.XDomainRequest?ge(t):ve(t));if(t.enableXDR&&window.XDomainRequest)return void ge(t)}var o=function(n){if(t.lastIndex=0,S++,n||t.reconnect&&S<=t.maxReconnectOnClose){var o=n?0:e.reconnectInterval;f.ffTryingReconnect=!0,z("re-connecting",e.transport,e),he(l,t,o)}else ne(0,"maxReconnectOnClose reached")},r=function(e){n._beforeUnloadState?(n.util.debug(new Date+" Atmosphere: reconnectF: execution delayed due to _beforeUnloadState flag"),setTimeout((function(){o(e)}),5e3)):o(e)},c=function(){f.errorHandled=!0,P(),r(!1)};if(t.force||t.reconnect&&(-1===t.maxRequest||t.requestCount++<t.maxRequest)){t.force=!1;var l=n.util.xhr();l.hasData=!1,de(l,t,!0),t.suspend&&(w=l),"polling"!==t.transport&&(f.transport=t.transport,l.onabort=function(){A("ajaxrequest.onabort"),qe(!0)},l.onerror=function(){A("ajaxrequest.onerror"),f.error=!0,f.ffTryingReconnect=!0;try{f.status=XMLHttpRequest.status}catch(e){f.status=500}f.status||(f.status=500),f.errorHandled||(P(),r(!1))}),l.onreadystatechange=function(){if(A("ajaxRequest.onreadystatechange, new state: "+l.readyState),R)A("onreadystatechange has been ignored due to _abortingConnection flag");else{f.error=!1;var o=!1,d=!1;if("streaming"===t.transport&&t.readyState>2&&4===l.readyState)return P(),void r(!1);if(t.readyState=l.readyState,("streaming"===t.transport&&l.readyState>=3||"long-polling"===t.transport&&4===l.readyState)&&(d=!0),ee(h),"polling"!==t.transport){var m=200;if(4===l.readyState&&(m=l.status>1e3?0:l.status),!t.reconnectOnServerError&&m>=300&&m<600)return void ne(m,l.statusText);if(m>=300||0===m)return!t.isOpen&&F("warn")&&n.util.warn(t.transport+" connection failed with status: "+m+" "+(l.statusText||"Unable to connect")),void c();t.enableProtocol&&e.firstMessage||!(2===l.readyState||l.readyState>2&&!t.isOpen)||(n.util.browser.mozilla&&f.ffTryingReconnect?(f.ffTryingReconnect=!1,setTimeout((function(){f.ffTryingReconnect||ae(t)}),500)):ae(t))}else 4===l.readyState&&(d=!0);if(d){var v=l.responseText;if(f.errorHandled=!1,"long-polling"===t.transport&&0===n.util.trim(v).length)return void(l.hasData?l.hasData=!1:r(!0));if(l.hasData=!0,Me(l,h),"streaming"===t.transport)if(n.util.browser.opera)n.util.iterate((function(){if(500!==f.status&&l.responseText.length>t.lastIndex){try{f.status=l.status,f.headers=n.util.parseHeaders(l.getAllResponseHeaders()),Me(l,h)}catch(e){f.status=404}ee(h),f.state="messageReceived";var e=l.responseText.substring(t.lastIndex);if(t.lastIndex=l.responseText.length,(o=oe(e,t,f))||Le(),L(l,t))return void ue(l,t)}else if(f.status>400)return t.lastIndex=l.responseText.length,!1}),0);else{var w=v.substring(t.lastIndex,v.length);if(o=oe(w,t,f),t.lastIndex=v.length,o)return}else o=oe(v,t,f);var C=L(l,t);try{f.status=l.status,f.headers=n.util.parseHeaders(l.getAllResponseHeaders()),Me(l,t)}catch(e){f.status=404}t.suspend?f.state=0===f.status?"closed":"messageReceived":f.state="messagePublished";var y=!C&&"streaming"!==e.transport&&"polling"!==e.transport;y&&!t.executeCallbackBeforeReconnect&&he(l,t,t.pollingInterval),0===f.responseBody.length||o||Le(),y&&t.executeCallbackBeforeReconnect&&he(l,t,t.pollingInterval),C&&ue(l,t)}}};try{l.send(t.data),k=!0}catch(e){n.util.log(t.logLevel,["Unable to connect to "+t.url]),ne(0,e)}}else"debug"===t.logLevel&&n.util.log(t.logLevel,["Max re-connection reached."]),ne(0,"maxRequest reached")}}function ue(e,t){f.messages=[],t.isReopen=!0,D(),R=!1,he(e,t,500)}function de(e,t,o){var r=t.url;null!=t.dispatchUrl&&"POST"===t.method&&(r+=t.dispatchUrl),r=ie(t,r),r=n.util.prepareURL(r),o&&(e.open(t.method,r,!0),t.connectTimeout>0&&(t.id=setTimeout((function(){0===t.requestCount&&(P(),Ee("Connect timeout","closed",200,t.transport))}),t.connectTimeout))),h.withCredentials&&"websocket"!==h.transport&&"withCredentials"in e&&(e.withCredentials=!0),h.dropHeaders||(e.setRequestHeader("X-Atmosphere-Framework",n.version),e.setRequestHeader("X-Atmosphere-Transport",t.transport),null!==t.heartbeat&&null!==t.heartbeat.server&&e.setRequestHeader("X-Heartbeat-Server",e.heartbeat.server),t.trackMessageLength&&e.setRequestHeader("X-Atmosphere-TrackMessageSize","true"),e.setRequestHeader("X-Atmosphere-tracking-id",t.uuid),n.util.each(t.headers,(function(r,c){var l=n.util.isFunction(c)?c.call(this,e,t,o,f):c;null!=l&&e.setRequestHeader(r,l)}))),""!==t.contentType&&e.setRequestHeader("Content-Type",t.contentType)}function he(e,t,n){if(!f.closedByClientTimeout&&(t.reconnect||t.suspend&&k)){var o=0;if(e&&e.readyState>1&&(o=e.status>1e3?0:e.status),f.status=0===o?204:o,f.reason=0===o?"Server resumed the connection or down.":"OK",clearTimeout(t.id),t.reconnectId&&(clearTimeout(t.reconnectId),delete t.reconnectId),n>0){var r=h.handleOnlineOffline;h.handleOnlineOffline=!1,h.reconnectId=setTimeout((function(){h.handleOnlineOffline=r,le(t)}),n)}else le(t)}}function fe(e){e.state="re-connecting",Fe(e)}function pe(e){e.state="openAfterResume",Fe(e),e.state="messageReceived"}function ge(e){"polling"!==e.transport?(C=me(e)).open():me(e).open()}function me(e){var t=h;null!=e&&void 0!==e&&(t=e);var o=t.transport,r=0,c=new window.XDomainRequest,l=function(){"long-polling"===t.transport&&t.reconnect&&(-1===t.maxRequest||t.requestCount++<t.maxRequest)&&(c.status=200,ge(t))},d=t.rewriteURL||function(e){var t=/(?:^|;\s*)(JSESSIONID|PHPSESSID)=([^;]*)/.exec(document.cookie);switch(t&&t[1]){case"JSESSIONID":return e.replace(/;jsessionid=[^\?]*|(\?)|$/,";jsessionid="+t[2]+"$1");case"PHPSESSID":return e.replace(/\?PHPSESSID=[^&]*&?|\?|$/,"?PHPSESSID="+t[2]+"&").replace(/&$/,"")}return e};c.onprogress=function(){m(c)},c.onerror=function(){"polling"!==t.transport&&(P(),S++<t.maxReconnectOnClose?t.reconnectInterval>0?t.reconnectId=setTimeout((function(){z("re-connecting",e.transport,e),ge(t)}),t.reconnectInterval):(z("re-connecting",e.transport,e),ge(t)):ne(0,"maxReconnectOnClose reached"))},c.onload=function(){};var m=function(e){clearTimeout(t.id);var c=e.responseText;if(c=c.substring(r),r+=c.length,"polling"!==o){ee(t);var d=oe(c,t,f);if("long-polling"===o&&0===n.util.trim(c).length)return;t.executeCallbackBeforeReconnect&&l(),d||Ee(f.responseBody,"messageReceived",200,o),t.executeCallbackBeforeReconnect||l()}};return{open:function(){var e=t.url;null!=t.dispatchUrl&&(e+=t.dispatchUrl),e=ie(t,e),c.open(t.method,d(e)),"GET"===t.method?c.send():c.send(t.data),t.connectTimeout>0&&(t.id=setTimeout((function(){0===t.requestCount&&(P(),Ee("Connect timeout","closed",200,t.transport))}),t.connectTimeout))},close:function(){c.abort()}}}function ve(e){(C=be(e)).open()}function be(e){var t,o=h;null!=e&&void 0!==e&&(o=e);var r=new window.ActiveXObject("htmlfile");r.open(),r.close();var c=o.url;return null!=o.dispatchUrl&&(c+=o.dispatchUrl),"polling"!==o.transport&&(f.transport=o.transport),{open:function(){var iframe=r.createElement("iframe");c=ie(o),""!==o.data&&(c+="&X-Atmosphere-Post-Body="+encodeURIComponent(o.data)),c=n.util.prepareURL(c),iframe.src=c,r.body.appendChild(iframe);var e=iframe.contentDocument||iframe.contentWindow.document;t=n.util.iterate((function(){try{if(!e.firstChild)return;var c=e.body?e.body.lastChild:e;c.omgThisIsBroken;var l=function(){var t=c.cloneNode(!0);t.appendChild(e.createTextNode("."));var text=t.innerText;return text=text.substring(0,text.length-1)};if(!e.body||!e.body.firstChild||"pre"!==e.body.firstChild.nodeName.toLowerCase()){var head=e.head||e.getElementsByTagName("head")[0]||e.documentElement||e,script=e.createElement("script");script.text="document.write('<plaintext>')",head.insertBefore(script,head.firstChild),head.removeChild(script),c=e.body.lastChild}return o.closed&&(o.isReopen=!0),t=n.util.iterate((function(){var text=l();if(text.length>o.lastIndex){if(ee(h),f.status=200,f.error=!1,c.innerText="",oe(text,o,f))return"";Ee(f.responseBody,"messageReceived",200,o.transport)}if(o.lastIndex=0,"complete"===e.readyState)return qe(!0),z("re-connecting",o.transport,o),o.reconnectInterval>0?o.reconnectId=setTimeout((function(){ve(o)}),o.reconnectInterval):ve(o),!1}),null),!1}catch(e){return f.error=!0,z("re-connecting",o.transport,o),S++<o.maxReconnectOnClose?o.reconnectInterval>0?o.reconnectId=setTimeout((function(){ve(o)}),o.reconnectInterval):ve(o):ne(0,"maxReconnectOnClose reached"),r.execCommand("Stop"),r.close(),!1}}))},close:function(){t&&t(),r.execCommand("Stop"),qe(!0)}}}function we(e){null!=x?ye(e):null!=w||null!=v?Se(e):null!=C?Te(e):null!=y?Ie(e):null!=m?xe(e):(ne(0,"No suspended connection available"),n.util.error("No suspended connection available. Make sure atmosphere.subscribe has been called and request.onOpen invoked before trying to push data"))}function Ce(e,t){t||(t=Oe(e)),t.transport="polling",t.method="GET",t.withCredentials=!1,t.reconnect=!1,t.force=!0,t.suspend=!1,t.timeout=1e3,h.unloadBackwardCompat?le(t):navigator.sendBeacon(t.url,t.data)}function ye(e){x.send(e)}function ke(e){if(0!==e.length)try{x?x.localSend(e):t&&t.signal("localMessage",JSON.stringify({id:_,event:e}))}catch(e){n.util.error(e)}}function Se(e){le(Oe(e))}function Te(e){if(h.enableXDR&&n.util.checkCORSSupport()){var t=Oe(e);t.reconnect=!1,Q(t)}else Se(e)}function Ie(e){Se(e)}function Re(e){var t=e;return"object"==typeof t&&(t=e.data),t}function Oe(e){var t=Re(e),o={connected:!1,timeout:6e4,method:"POST",url:h.url,contentType:h.contentType,headers:h.headers,reconnect:!0,callback:null,data:t,suspend:!1,maxRequest:-1,logLevel:"info",requestCount:0,withCredentials:h.withCredentials,transport:"polling",isOpen:!0,attachHeadersAsQueryString:!0,enableXDR:h.enableXDR,uuid:h.uuid,dispatchUrl:h.dispatchUrl,enableProtocol:!1,messageDelimiter:"|",trackMessageLength:h.trackMessageLength,maxReconnectOnClose:h.maxReconnectOnClose,heartbeatTimer:h.heartbeatTimer,heartbeat:h.heartbeat};return"object"==typeof e&&(o=n.util.extend(o,e)),o}function xe(e){var data,t=n.util.isBinary(e)?e:Re(e);try{if(data=null!=h.dispatchUrl?h.webSocketPathDelimiter+h.dispatchUrl+h.webSocketPathDelimiter+t:t,!m.canSendMessage)return void n.util.error("WebSocket not connected.");m.send(data)}catch(t){m.onclose=function(){},P(),se("Websocket failed. Downgrading to "+h.fallbackTransport+" and resending "+e),Se(e)}}function _e(e){var t=JSON.parse(e);t.id!==_&&(void 0!==h.onLocalMessage?h.onLocalMessage(t.event):void 0!==n.util.onLocalMessage&&n.util.onLocalMessage(t.event))}function Ee(e,t,n,o){f.responseBody=e,f.transport=o,f.status=n,f.state=t,Le()}function Me(e,t){if(t.readResponsesHeaders)try{var n=e.getResponseHeader("X-Atmosphere-tracking-id");n&&null!=n&&(t.uuid=n.split(" ").pop())}catch(e){}else t.enableProtocol||(t.uuid=_)}function Fe(e){Ae(e,h),Ae(e,n.util)}function Ae(e,t){switch(e.state){case"messageReceived":A("Firing onMessage"),S=0,void 0!==t.onMessage&&t.onMessage(e),void 0!==t.onmessage&&t.onmessage(e);break;case"error":A("Firing onError, reasonPhrase: "+(void 0!==e.reasonPhrase?e.reasonPhrase:"n/a")),void 0!==t.onError&&t.onError(e),void 0!==t.onerror&&t.onerror(e);break;case"opening":delete h.closed,A("Firing onOpen"),void 0!==t.onOpen&&t.onOpen(e),void 0!==t.onopen&&t.onopen(e);break;case"messagePublished":A("Firing messagePublished"),void 0!==t.onMessagePublished&&t.onMessagePublished(e);break;case"re-connecting":A("Firing onReconnect"),void 0!==t.onReconnect&&t.onReconnect(h,e);break;case"closedByClient":A("Firing closedByClient"),void 0!==t.onClientTimeout&&t.onClientTimeout(h);break;case"re-opening":delete h.closed,A("Firing onReopen"),void 0!==t.onReopen&&t.onReopen(h,e);break;case"fail-to-reconnect":A("Firing onFailureToReconnect"),void 0!==t.onFailureToReconnect&&t.onFailureToReconnect(h,e);break;case"unsubscribe":case"closed":void 0!==h.closed&&h.closed?A("Request already closed, not firing onClose ("+e.state+" case)"):(A("Firing onClose ("+e.state+" case)"),void 0!==t.onClose&&t.onClose(e),void 0!==t.onclose&&t.onclose(e)),h.closed=!0;break;case"openAfterResume":void 0!==t.onOpenAfterResume&&t.onOpenAfterResume(h)}}function qe(e){"closed"!==f.state&&(f.state="closed",f.responseBody="",f.messages=[],f.status=e?200:501,Le())}function Le(){var e=function(e,t){t(f)};null==x&&null!=O&&O(f.responseBody),h.reconnect=h.mrequest;for(var t="string"==typeof f.responseBody,o=t&&h.trackMessageLength?f.messages.length>0?f.messages:[""]:new Array(f.responseBody),i=0;i<o.length;i++)if(!(o.length>1&&0===o[i].length)){if(f.responseBody=t?n.util.trim(o[i]):o[i],null==x&&null!=O&&O(f.responseBody),"messageReceived"===f.state){if(0===f.responseBody.length)continue;if(t&&I===f.responseBody){S=0;continue}}if(Fe(f),c.length>0){F("debug")&&n.util.debug("Invoking "+c.length+" global callbacks: "+f.state);try{n.util.each(c,e)}catch(e){n.util.log(h.logLevel,["Callback exception"+e])}}if("function"==typeof h.callback){F("debug")&&n.util.debug("Invoking request callbacks");try{h.callback(f)}catch(e){n.util.log(h.logLevel,["Callback exception"+e])}}}}U(e),this.subscribe=function(e){U(e),X()},this.execute=function(){X()},this.close=function(){D()},this.disconnect=function(){N()},this.getUrl=function(){return h.url},this.push=function(e,t){if(null!=t){var n=h.dispatchUrl;h.dispatchUrl=t,we(e),h.dispatchUrl=n}else we(e)},this.getUUID=function(){return h.uuid},this.pushLocal=function(e){ke(e)},this.enableProtocol=function(){return h.enableProtocol},this.init=function(){E()},this.request=h,this.response=f}}).subscribe=function(e,t,o){"function"==typeof t&&n.addCallback(t),"string"!=typeof e?o=e:o.url=e,l=void 0!==o&&void 0!==o.uuid?o.uuid:0;var c=new n.AtmosphereRequest(o);return c.execute(),r[r.length]=c,c},n.unsubscribe=function(){if(r.length>0)for(var e=[].concat(r),i=0;i<e.length;i++){var t=e[i];t.close(),clearTimeout(t.response.request.id),t.heartbeatTimer&&clearTimeout(t.heartbeatTimer)}r=[],c=[]},n.unsubscribeUrl=function(e){var t=-1;if(r.length>0)for(var i=0;i<r.length;i++){var n=r[i];if(n.getUrl()===e){n.close(),clearTimeout(n.response.request.id),n.heartbeatTimer&&clearTimeout(n.heartbeatTimer),t=i;break}}t>=0&&r.splice(t,1)},n.addCallback=function(e){-1===n.util.inArray(e,c)&&c.push(e)},n.removeCallback=function(e){var t=n.util.inArray(e,c);-1!==t&&c.splice(t,1)},n.util={browser:{},parseHeaders:function(e){for(var t,n=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,o={};t=n.exec(e);)o[t[1]]=t[2];return o},now:function(){return(new Date).getTime()},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},inArray:function(e,t){if(!Array.prototype.indexOf){for(var n=t.length,i=0;i<n;++i)if(t[i]===e)return i;return-1}return t.indexOf(e)},isBinary:function(data){return/^\[object\s(?:Blob|ArrayBuffer|.+Array)\]$/.test(Object.prototype.toString.call(data))},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},getAbsoluteURL:function(e){if(void 0===document.createElement)return e;var div=document.createElement("div");div.innerHTML='<a href="'+e+'"></a>';var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0?n.util.fixedEncodeURI(decodeURI(div.firstChild.href)):div.firstChild.href},fixedEncodeURI:function(e){return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")},prepareURL:function(e){var t=n.util.now(),o=e.replace(/([?&])_=[^&]*/,"$1_="+t);return o+(o===e?(/\?/.test(e)?"&":"?")+"_="+t:"")},trim:function(e){return String.prototype.trim?e.toString().trim():e.toString().replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},param:function(e){var t,s=[];function o(e,t){t=n.util.isFunction(t)?t():null==t?"":t,s.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}function r(e,t){var c;if(n.util.isArray(t))n.util.each(t,(function(i,t){/\[\]$/.test(e)?o(e,t):r(e+"["+("object"==typeof t?i:"")+"]",t)}));else if("[object Object]"===Object.prototype.toString.call(t))for(c in t)r(e+"["+c+"]",t[c]);else o(e,t)}for(t in e)r(t,e[t]);return s.join("&").replace(/%20/g,"+")},storage:function(){try{return!(!window.localStorage||!window.StorageEvent)}catch(e){return!1}},iterate:function(e,t){var n;return t=t||0,function o(){n=setTimeout((function(){!1!==e()&&o()}),t)}(),function(){clearTimeout(n)}},each:function(e,t,o){if(e){var i=0,r=e.length,c=n.util.isArray(e);if(o){if(c)for(;i<r&&!1!==t.apply(e[i],o);i++);else for(i in e)if(!1===t.apply(e[i],o))break}else if(c)for(;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e}},extend:function(e){var i,t,n;for(i=1;i<arguments.length;i++)if(null!=(t=arguments[i]))for(n in t)e[n]=t[n];return e},on:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},off:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},log:function(e,t){if(window.console){var n=window.console[e];"function"==typeof n&&n.apply(window.console,t)}},warn:function(){n.util.log("warn",arguments)},info:function(){n.util.log("info",arguments)},debug:function(){n.util.log("debug",arguments)},error:function(){n.util.log("error",arguments)},xhr:function(){try{return new window.XMLHttpRequest}catch(e){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},checkCORSSupport:function(){if(n.util.browser.msie&&!window.XDomainRequest&&+n.util.browser.version.split(".")[0]<11)return!0;if(n.util.browser.opera&&+n.util.browser.version.split(".")<12)return!0;if("KreaTVWebKit/531"===n.util.trim(navigator.userAgent).slice(0,16))return!0;if("kreatel"===n.util.trim(navigator.userAgent).slice(-7).toLowerCase())return!0;var e=navigator.userAgent.toLowerCase().match(/.+android ([0-9]{1,2})/i),t=parseInt(e&&e[0]||-1,10);return!isNaN(t)&&t>-1&&t<3}},n.util.now(),e=navigator.userAgent.toLowerCase(),"safari"===(t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(e)||e.indexOf("android")<0&&/version\/(.+) (safari)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[])[2]&&(t[2]=t[1],t[1]="safari"),n.util.browser[t[1]||""]=!0,n.util.browser.version=t[2]||"0",n.util.browser.vmajor=n.util.browser.version.split(".")[0],n.util.browser.trident&&(n.util.browser.msie=!0),(n.util.browser.msie||n.util.browser.mozilla&&1==+n.util.browser.version.split(".")[0])&&(n.util.storage=!1),n.callbacks={unload:function(){n.util.debug(new Date+" Atmosphere: unload event"),n.unsubscribe()},beforeUnload:function(){n.util.debug(new Date+" Atmosphere: beforeunload event"),n._beforeUnloadState=!0,setTimeout((function(){n.util.debug(new Date+" Atmosphere: beforeunload event timeout reached. Reset _beforeUnloadState flag"),n._beforeUnloadState=!1}),5e3)},offline:function(){if(n.util.debug(new Date+" Atmosphere: offline event"),o=!0,r.length>0)for(var e=[].concat(r),i=0;i<e.length;i++){var t=e[i];t.request.handleOnlineOffline&&(t.close(),clearTimeout(t.response.request.id),t.heartbeatTimer&&clearTimeout(t.heartbeatTimer))}},online:function(){if(n.util.debug(new Date+" Atmosphere: online event"),r.length>0)for(var i=0;i<r.length;i++)r[i].request.handleOnlineOffline&&(r[i].init(),r[i].execute());o=!1}},n.bindEvents=function(){n.util.on(window,"unload",n.callbacks.unload),n.util.on(window,"beforeunload",n.callbacks.beforeUnload),n.util.on(window,"offline",n.callbacks.offline),n.util.on(window,"online",n.callbacks.online)},n.unbindEvents=function(){n.util.off(window,"unload",n.callbacks.unload),n.util.off(window,"beforeunload",n.callbacks.beforeUnload),n.util.off(window,"offline",n.callbacks.offline),n.util.off(window,"online",n.callbacks.online)},n.bindEvents(),n},void 0===(r="function"==typeof o?o.call(t,n,t,e):o)||(e.exports=r)},1808:function(e,t,n){"use strict";(function(o){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(1),t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(r=o))})),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(1809)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(80))},1809:function(e,t,n){"use strict";e.exports=function(e){function t(e){for(var t=0,i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return o.colors[Math.abs(t)%o.colors.length]}function o(e){var n;function l(){if(l.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var c=l,d=Number(new Date),h=d-(n||d);c.diff=h,c.prev=n,c.curr=d,n=d,t[0]=o.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var f=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;f++;var r=o.formatters[n];if("function"==typeof r){var l=t[f];e=r.call(c,l),t.splice(f,1),f--}return e})),o.formatArgs.call(c,t),(c.log||o.log).apply(c,t)}}return l.namespace=e,l.enabled=o.enabled(e),l.useColors=o.useColors(),l.color=t(e),l.destroy=r,l.extend=c,"function"==typeof o.init&&o.init(l),o.instances.push(l),l}function r(){var e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function c(e,t){return o(this.namespace+(void 0===t?":":t)+e)}return o.debug=o,o.default=o,o.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},o.disable=function(){o.enable("")},o.enable=function(e){var i;o.save(e),o.names=[],o.skips=[];var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length;for(i=0;i<n;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(i=0;i<o.instances.length;i++){var r=o.instances[i];r.enabled=o.enabled(r.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;var i,t;for(i=0,t=o.skips.length;i<t;i++)if(o.skips[i].test(e))return!1;for(i=0,t=o.names.length;i<t;i++)if(o.names[i].test(e))return!0;return!1},o.humanize=n(1810),Object.keys(e).forEach((function(t){o[t]=e[t]})),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=t,o.enable(o.load()),o}},1810:function(e,t){var s=1e3,n=60*s,o=60*n,r=24*o,c=7*r,l=365.25*r;function d(e,t,n,o){var r=t>=1.5*n;return Math.round(e/n)+" "+o+(r?"s":"")}e.exports=function(e,t){t=t||{};var h=typeof e;if("string"===h&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var d=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return d*l;case"weeks":case"week":case"w":return d*c;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*o;case"minutes":case"minute":case"mins":case"min":case"m":return d*n;case"seconds":case"second":case"secs":case"sec":case"s":return d*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}(e);if("number"===h&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=r)return d(e,t,r,"day");if(t>=o)return d(e,t,o,"hour");if(t>=n)return d(e,t,n,"minute");if(t>=s)return d(e,t,s,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=r)return Math.round(e/r)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=s)return Math.round(e/s)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},351:function(e,t,n){"use strict";n.r(t),n.d(t,"TLMetric",(function(){return E})),n.d(t,"TLSocket",(function(){return F})),n.d(t,"createSocket",(function(){return D})),n.d(t,"configure",(function(){return P})),n.d(t,"getDefaultSocket",(function(){return B}));var o=n(1806),r=n.n(o),c=n(1808),l=n.n(c);let d={connection:l()("atmosphere-client:connection"),connectionRaw:l()("atmosphere-client:connection-raw"),incoming:l()("atmosphere-client:incoming"),incomingRaw:l()("atmosphere-client:incoming-raw"),outgoing:l()("atmosphere-client:outgoing"),outgoingRaw:l()("atmosphere-client:outgoing-raw")};const h=3e3,f="CONN_CLOSED_REASON_EXPLICIT",m="CONN_CLOSED_REASON_AUTH",v="close",w="reconnecting",C="disconnect",y="connect",k="reconnect",S="offline",T="online",I="error",R="clientTimeout";class O{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;this.socket=e,this.pingInterval=t}start(){let e=this;this.stop(),this.pingTimeoutId=window.setInterval((function(){e._ping()}),1e3*e.pingInterval)}stop(){this.pingTimeoutId&&(window.clearInterval(this.pingTimeoutId),this.pingTimeoutId=null)}_ping(){this.socket.send("core.ping")}}class x{constructor(e,t){this.fn=e,this.wasCalled=!1,this.timeInSeconds=t,this._start()}_start(){var e=this;this.timerId=window.setInterval((function(){e._step()}),1e3)}_step(){this.wasCalled||(this.timeInSeconds-=1,this.timeInSeconds<=0&&(this.wasCalled=!0,this.stop(),this.fn()))}stop(){window.clearInterval(this.timerId)}getCountdown(){return this.timeInSeconds}}class _{constructor(e){this.socket=e,this.pingInterval=this.getInitialPingInterval()}getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}getInitialPingInterval(){return this.getRandomInt(10,30)}activateThrottling(){let e=this.getRandomInt(60,120);this.pingInterval=Math.max(this.pingInterval,e)}start(){let e=this;this.stop(),this.countdownTimer=new x((function(){e._ping()}),e.pingInterval),this.resetTimer&&clearTimeout(this.resetTimer)}reset(e){let t=this;e?this._reset():(clearTimeout(this.resetTimer),this.resetTimer=setTimeout((function(){t._reset()}),3e4)),this.stop()}_reset(){this.pingInterval=this.getInitialPingInterval(),clearTimeout(this.resetTimer),this.resetTimer=null}stop(){this.countdownTimer&&(this.countdownTimer.stop(),this.countdownTimer=null)}getCountdown(){return this.countdownTimer?this.countdownTimer.getCountdown():0}_ping(){this.stop(),this.socket.reconnect(),this.pingInterval+=this.pingInterval;var e=this.getRandomInt(60,90);this.pingInterval=Math.max(e,Math.min(this.pingInterval,300)),this.start()}}class E{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,n=this;if(0===t)throw new Error("flushInterval cannot be zero");this.socket=e,this.flushInterval=t,this.queue=[],this.measurements={},window.setInterval((function(){n._flush()}),n.flushInterval)}start(e,time){this.measurements[e]={name:e,time:time||Date.now()}}stop(e,time){let t=this.measurements[e];t&&(t.time=(time||Date.now())-t.time,this.queue.push(t),delete this.measurements[e])}_flush(){this.queue.length&&(this.socket.isConnected()&&this.socket.emit("metric.batch",{list:this.queue}),this.queue=[])}}class M{constructor(e){this.capacity=e,this.buffer=[],this.length=0,this.pointer=0}get(e){return this.buffer[e]}push(e){this.buffer[this.pointer]=e,this.pointer=(this.capacity+this.pointer+1)%this.capacity,this.length=this.buffer.length}all(){return 0===this.pointer||this.buffer.length<this.capacity?this.buffer:this.buffer.slice(this.pointer).concat(this.buffer.slice(0,this.pointer))}}class F{constructor(e,t,n){this.baseUrl=t,this.messageQueue=[],this.requests={},this.requestIdSeq=1,this.eventHandlers={},this.query={},this.logErrors=!0,this.atmosphere=e,this.ackTimeout=n&&n.ackTimeout||3e4,this.eventsMaxCount=n&&n.eventsMaxCount||500,this.eventsDataMaxSize=n&&n.eventsDataMaxSize||1e4,this.events=new M(this.eventsMaxCount),this.trackMessageLength=!n||!1!==n.trackMessageLength,n&&n.metric&&n.metric.enabled&&(this.tlMetric=new E(this,n.metric.flushInterval)),this.libVersion="{{ VERSION }}",this.keepAlivePing=new O(this),this.reconnectPing=new _(this),n&&n.query&&(this.query=n.query),this.query.app||(this.query.app="other"),this.query.libVersion=this.libVersion,this.trackMessageLength&&(this.query.tml=this.trackMessageLength),this._startOnlineCheck(),this._resetFailureReconnect()}send(e,data){if(this.isClosed())return Promise.reject({type:v,message:"The connection is currently closed, no requests allowed"});if("core.ping"!==e&&!this.isConnected()&&this.wasConnected)return Promise.reject({type:v,message:"The connection is currently reconnecting, no requests allowed"});let t,p=new Promise((function(n,o){t={tries:0,promise:{resolve:n,reject:o},eventName:e,eventType:"RPC",args:data}}));return this._send(t),p}emit(e,data){let t;this.isClosed()||!this.isConnected()&&this.wasConnected||(this._connect(),t={eventName:e,eventType:"CLIENT_PUSH",data:data},this._pushWhenConnected(t))}on(e,t){let n=this;return this.eventHandlers[e]||(n.eventHandlers[e]=[]),n.eventHandlers[e].push(t),function(){n._off(e,t)}}dispatchEvent(e,data){let t=this.eventHandlers[e];t&&t.length&&this._forIn(t,(function(e){e(data)}))}reconnect(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(this.disconnect(),this._handleChangeSocketStatus(w)):this.isConnected()?new Promise((function(e,t){e("Already connected")})):this._handleChangeSocketStatus(w)}disconnect(){this._handleChangeSocketStatus(C,f)}close(e){this._handleChangeSocketStatus(v,e)}isClosed(){return this.socketStatus===v}isConnected(){return this.socket&&(this.socketStatus===y||this.socketStatus===k)}getSocketStatus(){return this.socketStatus}getReconnectCountdown(){return this.reconnectPing.getCountdown()}getEvents(){return this.events.all()}getLastMessageTimestamp(){return this.lastMessageTimestamp}decodeBase64Data(data){return decodeURIComponent(atob(data).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}_pushWhenConnected(data){this.isConnected()?this._push(data):this.messageQueue.push(data)}_push(data){this.tlMetric&&data.requestId&&this.tlMetric.start("rid:"+data.requestId);let body=JSON.stringify(data);var e;if(body.length>3e6)return console.warn("Request max frame size limit excedded, dropping frame"),void(data.requestId&&(e=this.requests[data.requestId])&&e.promise.reject({type:"error",message:"Request max frame size limit excedded"}));this.socket.push(body),"auth"===data.eventName&&data.args&&data.args.password&&((data=JSON.parse(body)).args.password="******",body=JSON.stringify(data)),d.outgoingRaw(body),d.outgoing(data),this._addEvent("out",body)}_processMessageQueue(){this._forEach(this.messageQueue,this._push),this._resetMessageQueue()}_resetMessageQueue(){this.messageQueue.length=0}_send(e){let t=this,n=this._getNextRequestId();var o=this.ackTimeout;l.a.enabled("atmosphere-client:latency")&&(o*=2),this._connect(),e.requestId=n,this.requests[n]=e,e.timeoutId=window.setTimeout((function(){let e=t.requests[n];e&&e.promise&&(t.tlMetric&&t.tlMetric.stop("rid:"+n),e.promise.reject([{type:"timeout",message:"Sorry, but there was an issue communicating with the server.",data:{timeout:t.ackTimeout,args:[e.eventName,e.args]}}]),delete t.requests[n])}),o),e.tries++;let r={requestId:e.requestId,eventName:e.eventName,eventType:e.eventType,args:e.args};l.a.enabled("atmosphere-client:latency")&&(r.latency=!0),this._pushWhenConnected(r)}_off(e,t){let n=this.eventHandlers[e],o=n&&n.indexOf(t);n&&-1!==o&&n.splice(o,1)}_handleSocketEvent(e,t){let data;d.connection(e),d.connectionRaw(e),this._addEvent(e,t.responseBody);try{e===I?data=t.reasonPhrase:e===y?t.request&&(data=t.request.uuid,this.oldConnId=data):data=t.responseBody?JSON.parse(t.responseBody):JSON.parse(JSON.stringify(t))}catch(e){}this._handleChangeSocketStatus(e,data)}_handleSocketMessage(e){let time=Date.now(),body=e.responseBody;d.incomingRaw(body),this._addEvent("in",body);try{this.query&&this.query.base64&&(body=this.decodeBase64Data(body)),body=JSON.parse(body),d.incoming(body)}catch(e){"X"!==body&&this._logError("failed to parse response body:",e,body)}if(this.lastMessageTimestamp&&time-this.lastMessageTimestamp>18e4&&!this.resetLastMessageTimestamp)return this._handleChangeSocketStatus(C),this._resetMessageQueue(),void(this.resetLastMessageTimestamp=!0);this.lastMessageTimestamp=time,this.resetLastMessageTimestamp=!1,this.isConnected()||(body.connectionId&&(this.oldConnId=body.connectionId),this._handleChangeSocketStatus(y));let t=body.requestId,n=t&&this.requests[t];if(n)if(this.tlMetric&&this.tlMetric.stop("rid:"+t,time),window.clearTimeout(n.timeoutId),delete this.requests[t],body.errors){if(429===body.errors[0].code&&n.tries<2)return void setTimeout(function(){this._send(n)}.bind(this),1e3);n.promise.reject(body.errors)}else n.promise.resolve(body.data);else body.eventName&&"CONNECTION_CLOSED"===body.eventName?this._handleChangeSocketStatus(C,body.data?body.data.reason:void 0):body.eventName?this.dispatchEvent(body.eventName,body.data):body.errors&&body.errors.length&&0===t?(this._forIn(this.requests,(function(e){e.promise.reject(body.errors)})),this.requests={}):body.type?this.dispatchEvent(body.type,body):0===t&&this.dispatchEvent("CONNECTION_SUCCESS",body.data)}_connect(){if(this.socket||!this.online)return;let e=this.baseUrl.split("?")[0];if(this.oldConnId&&(this.query.connIdsToClose=this.oldConnId),this.query){e+="?";let t=[];this._forIn(this.query,(function(e,n){t.push(n+"="+encodeURIComponent(e))})),e+=t.join("&")}let t=(new this.atmosphere.AtmosphereRequest).request;t.url=e,t.enableXDR=!0,t.transport="websocket",t.fallbackTransport="none",t.reconnect=!1,t.connectTimeout=25e3,t.reconnectInterval=3e5,t.timeout=9e4,t.maxReconnectOnClose=100,t.closeAsync=!0,t.trackMessageLength=this.trackMessageLength,t.onMessage=this._handleSocketMessage.bind(this);let n={[y]:"Open",[C]:"Close",[w]:"Reconnect",[k]:"Reopen",[I]:"Error",[R]:"ClientTimeout"};this._forIn(n,function(e,n){t["on"+e]=this._handleSocketEvent.bind(this,n)}.bind(this)),this.socket=this.atmosphere.subscribe(t)}_cleanSocket(){let e=this.socket;this.socket=null,e&&this.atmosphere.unsubscribe(),this._forIn(this.requests,(function(e){e.promise.reject({errors:[{type:"connect",message:"Sorry, but there was an issue communicating with the server."}]})})),this.requests={},this._resetMessageQueue(),this.requestIdSeq=1}_startOnlineCheck(){"onLine"in window.navigator&&(this.online=window.navigator.onLine,window.setInterval(function(){!1===this.online&&window.navigator.onLine&&this._setOnline(!0)}.bind(this),3e3),this.atmosphere.util.on(window,"online",function(){this._setOnline(!0)}.bind(this)),this.atmosphere.util.on(window,"offline",function(){this._setOnline(!1)}.bind(this)))}_setOnline(e){this.online!==e&&(this.online=e,this._handleChangeSocketStatus(this.online?T:S))}_handleChangeSocketStatus(e,data,t){let n=e,o=["LOGOUT","REMOVED_FROM_ORG","INVALID_ORG","TOKEN_EXPIRED"];[C,I,R].indexOf(e)>-1&&(n=C),[y,k].indexOf(e)>-1&&(n=y);let r=this.socketStatus;[C,I].indexOf(this.socketStatus)>-1&&(r=C),[y,k].indexOf(this.socketStatus)>-1&&(r=y);const c=e===C&&data===f;if((this.socketStatus!==v||c)&&(this.socketStatus!==S||e===T)&&(n!==r||c))if(e===v)d.connection("explicit close"),this._addEvent("explicitDisconnect"),this.wasConnected=!1,this.keepAlivePing.stop(),this.reconnectPing.reset(!0),this._setSocketStatusAndNotify(v,data),this._cleanSocket(),this._clearDebouncedCallbackIfDisconnected();else if(e===C&&"CONN_CLOSED_REASON_CONNS_LIMIT_REACHED"===data)this._handleChangeSocketStatus(v,data);else if(e===C&&"CLOSING_CONNECTION_DUE_TO_THROTTLING"===data)this.keepAlivePing.stop(),this.reconnectPing.activateThrottling(),this._setSocketStatusAndNotify(C,data),this._cleanSocket(),this._clearDebouncedCallbackIfDisconnected(),this.reconnectPing.getCountdown()||this.reconnectPing.start();else if(e!==C||data!==f&&data!==m&&!o.includes(data))if([C,I,R].indexOf(e)>-1)this.keepAlivePing.stop(),this._setSocketStatusAndNotify(C,data,e),this._cleanSocket(),this.failureReconnect.attempt.current<this.failureReconnect.attempt.max?(this.failureReconnect.attempt.current+=1,this._debouncedCallbackIfDisconnected(function(){this.reconnectPing.reset(!0),this.failureReconnect.delay.current=Math.min(h,2*this.failureReconnect.delay.current),this._handleChangeSocketStatus(w)}.bind(this),this.failureReconnect.delay.current)):this._handleChangeSocketStatus(v,"CONN_CLOSED_REASON_TL_FAILURE");else if(e===y)d.connectionRaw("starting keep alive ping"),this.keepAlivePing.start(),this.reconnectPing.reset(),this._processMessageQueue(),this._resetFailureReconnect(),this._setSocketStatusAndNotify(this.wasConnected?k:y,data),this.wasConnected=!0;else if(e===w){if(!this.reconnectPing.getCountdown())return this._setSocketStatusAndNotify(e,data),this.send("core.ping").catch(function(e){return e&&e.length&&(e.some(function(e){return 401===e.code}.bind(this))?this._handleChangeSocketStatus(C,m):e.some(function(e){return 403===e.code}.bind(this))&&this._handleChangeSocketStatus(C,f)),Promise.reject(e)}.bind(this))}else e===S?(this.keepAlivePing.stop(),this.reconnectPing.reset(),this._cleanSocket(),this._setSocketStatusAndNotify(e,data)):e===T&&(this._setSocketStatusAndNotify(e,data),this.reconnectPing.reset(!0),this._handleChangeSocketStatus(w));else d.connection("explicit disconnect "+data),this._addEvent("explicitDisconnect"),this.wasConnected=!1,this.keepAlivePing.stop(),this._setSocketStatusAndNotify(C,data),this._cleanSocket(),this._clearDebouncedCallbackIfDisconnected(),this.reconnectPing.reset(!0)}_setSocketStatusAndNotify(e,data,t){e!==this.socketStatus&&(d.connectionRaw("setting status to "+e+" | "+(t||e)),this.socketStatus=e,this.dispatchEvent(e,data))}_logError(){let e=Array.prototype.slice.call(arguments);(this.debug||this.logErrors)&&(e.unshift("[transport-layer-client]"),console.error.apply(console,e))}_addEvent(e,data){var t={timestamp:Date.now(),eventType:e};void 0!==data&&(t.data=data),"string"==typeof data&&(t.data=data.substring(0,this.eventsDataMaxSize)),this.events.push(t)}_getNextRequestId(){return this.requestIdSeq++}_forEach(e,t){let data,i=0;for(;data=e[i++];)t.call(this,data)}_forIn(e,t){for(let n in e)t.call(this,e[n],n)}_clearDebouncedCallbackIfDisconnected(){clearTimeout(this._debouncedCallbackIfDisconnectedId)}_debouncedCallbackIfDisconnected(e,t){this._clearDebouncedCallbackIfDisconnected(),this._debouncedCallbackIfDisconnectedId=setTimeout(function(){this.socketStatus===C&&e()}.bind(this),t||10)}_resetFailureReconnect(){this.failureReconnect={delay:{current:300,max:h},attempt:{current:0,max:20}}}}var A,L,N;function D(e,t){return new F(r.a,e,t)}function P(e,t){A=e,L=t}function B(){return N||(N=D(A,L)),N}}}]);
//# sourceMappingURL=https://upwork-usw2-staging-assets-jsmaps.s3.us-west-2.amazonaws.com/ThunderNuxt/realtime.ae8d56e6.js.map